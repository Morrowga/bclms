(function(M,x){typeof exports=="object"&&typeof module<"u"?x(exports):typeof define=="function"&&define.amd?define(["exports"],x):(M=typeof globalThis<"u"?globalThis:M||self,x(M.Storybook={}))})(this,function(M){"use strict";var Vd=Object.defineProperty;var Gd=(M,x,lt)=>x in M?Vd(M,x,{enumerable:!0,configurable:!0,writable:!0,value:lt}):M[x]=lt;var a=(M,x,lt)=>(Gd(M,typeof x!="symbol"?x+"":x,lt),lt);var x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lt(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function mo(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var r=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return i[n]}})}),t}var Si={exports:{}};(function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(u,c,h){this.fn=u,this.context=c,this.once=h||!1}function s(u,c,h,d,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var f=new r(h,d||u,p),v=t?t+c:c;return u._events[v]?u._events[v].fn?u._events[v]=[u._events[v],f]:u._events[v].push(f):(u._events[v]=f,u._eventsCount++),u}function o(u,c){--u._eventsCount===0?u._events=new n:delete u._events[c]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var c=[],h,d;if(this._eventsCount===0)return c;for(d in h=this._events)e.call(h,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(h)):c},l.prototype.listeners=function(c){var h=t?t+c:c,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,f=d.length,v=new Array(f);p<f;p++)v[p]=d[p].fn;return v},l.prototype.listenerCount=function(c){var h=t?t+c:c,d=this._events[h];return d?d.fn?1:d.length:0},l.prototype.emit=function(c,h,d,p,f,v){var b=t?t+c:c;if(!this._events[b])return!1;var g=this._events[b],D=arguments.length,C,S;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),D){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,h),!0;case 3:return g.fn.call(g.context,h,d),!0;case 4:return g.fn.call(g.context,h,d,p),!0;case 5:return g.fn.call(g.context,h,d,p,f),!0;case 6:return g.fn.call(g.context,h,d,p,f,v),!0}for(S=1,C=new Array(D-1);S<D;S++)C[S-1]=arguments[S];g.fn.apply(g.context,C)}else{var V=g.length,A;for(S=0;S<V;S++)switch(g[S].once&&this.removeListener(c,g[S].fn,void 0,!0),D){case 1:g[S].fn.call(g[S].context);break;case 2:g[S].fn.call(g[S].context,h);break;case 3:g[S].fn.call(g[S].context,h,d);break;case 4:g[S].fn.call(g[S].context,h,d,p);break;default:if(!C)for(A=1,C=new Array(D-1);A<D;A++)C[A-1]=arguments[A];g[S].fn.apply(g[S].context,C)}}return!0},l.prototype.on=function(c,h,d){return s(this,c,h,d,!1)},l.prototype.once=function(c,h,d){return s(this,c,h,d,!0)},l.prototype.removeListener=function(c,h,d,p){var f=t?t+c:c;if(!this._events[f])return this;if(!h)return o(this,f),this;var v=this._events[f];if(v.fn)v.fn===h&&(!p||v.once)&&(!d||v.context===d)&&o(this,f);else{for(var b=0,g=[],D=v.length;b<D;b++)(v[b].fn!==h||p&&!v[b].once||d&&v[b].context!==d)&&g.push(v[b]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},l.prototype.removeAllListeners=function(c){var h;return c?(h=t?t+c:c,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,i.exports=l})(Si);var So=Si.exports;const X=lt(So);/*! js-cookie v3.0.5 | MIT */function ne(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)i[n]=t[n]}return i}var bo={read:function(i){return i[0]==='"'&&(i=i.slice(1,-1)),i.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(i){return encodeURIComponent(i).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function We(i,e){function t(r,s,o){if(!(typeof document>"u")){o=ne({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),r=encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var l="";for(var u in o)o[u]&&(l+="; "+u,o[u]!==!0&&(l+="="+o[u].split(";")[0]));return document.cookie=r+"="+i.write(s,r)+l}}function n(r){if(!(typeof document>"u"||arguments.length&&!r)){for(var s=document.cookie?document.cookie.split("; "):[],o={},l=0;l<s.length;l++){var u=s[l].split("="),c=u.slice(1).join("=");try{var h=decodeURIComponent(u[0]);if(o[h]=i.read(c,h),r===h)break}catch{}}return r?o[r]:o}}return Object.create({set:t,get:n,remove:function(r,s){t(r,"",ne({},s,{expires:-1}))},withAttributes:function(r){return We(this.converter,ne({},this.attributes,r))},withConverter:function(r){return We(ne({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(i)}})}var Pt=We(bo,{path:"/"});const m={CHANGE:"change",CLICK:"click",COMPLETE:"complete",ERROR:"error",FILE_LOAD:"fileload",MOUSE_DOWN:"mousedown",PRESS_MOVE:"pressmove",PRESS_UP:"pressup",PROGRESS:"progress",TICK:"tick"},bi=Object.values(m);function pt(i,e){const t=i.getChildByName(e);return t||void 0}function P(i,e){const t=pt(i,e);return t instanceof createjs.MovieClip?t:void 0}function ze(i){return i.labels}function Co(i){return i===Object(i)}function qe(i){const e=[];return i.forEach(t=>{Co(t)?e.push(F(t)):Array.isArray(t)?e.push(qe(t)):e.push(t)}),e}function O(i){return typeof i=="object"&&i!==null&&i.constructor===Object}function F(i){const e={};return Object.keys(i).forEach(t=>{const n=i[t];Array.isArray(n)?e[t]=qe(n):O(n)?e[t]=F(n):e[t]=n}),e}const Bo={BigButtonPres:"sndbigbuttonpress",Logo:"sndlogo",RadioHeavyButtonPress:"sndradioheavybuttonpress",RadioLightButtonPress:"sndradiolightbuttonpress",SyncTest:"sndsynctest",VolumeTest:"sndvolumetestwav"},Xe={SbInit:"sbinit",Start:"start"},w=Object.freeze({AreSettingsProtected:!0,CaptionHilites:{Colors:["#FFF450","#B9E5FB","#C6DD7F","#ED1846"],Stroke:{Color:"#333333",Thickness:2}},ContentVideoId:"contentVideo",ExitRedirectDelayMs:3e3,HtmlElementIds:{AnimationContainer:"animation_container",Canvas:"canvas",DomOverlayContainer:"dom_overlay_container",ProgressBarFill:"progressBarFill"},IntroCompleteWaitDelayMs:1500,TutorialIntroDelayMs:2500,Version:"2024.03.04.01"}),et={Cancel:"cancel",Close:"close",No:"no",Yes:"yes"},Po=Object.values(et),Y={DualSwitch:"dualSwitch",EyeTracker:"eyeTracker",SingleSwitch:"singleSwitch",TapMouse:"tapMouse"},Eo=Object.values(Y),I={Prev:"prev",Next:"next",Restart:"restart"},Do=Object.values(I),E={EngineConfig:{buttonsMenu:null,contentVideoUrl:"",exitRedirectUrl:"",navButtonsSoundKey:"",pressIndicatorDelay:2500,sceneHandler:null,shouldSkipIntro:!1,singleDeviceDelayMs:3e3,startCallback:null,startCallbackContext:void 0,shouldUseVideoBuffer:!0,shouldWaitForNavSounds:!1,storybookId:"",videoFps:30},MessagePanel:{AutoClose:{ButtonId:et.Close,DelayMs:1250},DimBack:{Alpha:.4,Color:"#000"}},SelectedNavButtonId:I.Next,Settings:{audio:{bgm:{isEnabled:!0,volume:.5},sound:{isEnabled:!0,volume:1},voice:{isEnabled:!0,volume:1}},device:{inputDevice:Y.TapMouse},hasCompletedTutorial:!1,storybook:{aacSymbolsEnabled:!0,captionsEnabled:!0,captionHiliteColorIndex:0,captionHilitesEnabled:!0,helpfulTipsEnabled:!0},storybooksStates:{}}};var Ci=Object.prototype.toString,Bi=function(e){var t=Ci.call(e),n=t==="[object Arguments]";return n||(n=t!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Ci.call(e.callee)==="[object Function]"),n},Ye,Pi;function wo(){if(Pi)return Ye;Pi=1;var i;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n=Bi,r=Object.prototype.propertyIsEnumerable,s=!r.call({toString:null},"toString"),o=r.call(function(){},"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(p){var f=p.constructor;return f&&f.prototype===p},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if(typeof window>"u")return!1;for(var p in window)try{if(!c["$"+p]&&e.call(window,p)&&window[p]!==null&&typeof window[p]=="object")try{u(window[p])}catch{return!0}}catch{return!0}return!1}(),d=function(p){if(typeof window>"u"||!h)return u(p);try{return u(p)}catch{return!1}};i=function(f){var v=f!==null&&typeof f=="object",b=t.call(f)==="[object Function]",g=n(f),D=v&&t.call(f)==="[object String]",C=[];if(!v&&!b&&!g)throw new TypeError("Object.keys called on a non-object");var S=o&&b;if(D&&f.length>0&&!e.call(f,0))for(var V=0;V<f.length;++V)C.push(String(V));if(g&&f.length>0)for(var A=0;A<f.length;++A)C.push(String(A));else for(var N in f)!(S&&N==="prototype")&&e.call(f,N)&&C.push(String(N));if(s)for(var at=d(f),G=0;G<l.length;++G)!(at&&l[G]==="constructor")&&e.call(f,l[G])&&C.push(l[G]);return C}}return Ye=i,Ye}var To=Array.prototype.slice,xo=Bi,Ei=Object.keys,ie=Ei?function(e){return Ei(e)}:wo(),Di=Object.keys;ie.shim=function(){if(Object.keys){var e=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);e||(Object.keys=function(n){return xo(n)?Di(To.call(n)):Di(n)})}else Object.keys=ie;return Object.keys||ie};var Qe=ie,re=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var r=42;e[t]=r;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==r||o.enumerable!==!0)return!1}return!0},wi=typeof Symbol<"u"&&Symbol,Ao=re,Je=function(){return typeof wi!="function"||typeof Symbol!="function"||typeof wi("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Ao()},Ti={foo:{}},Io=Object,ko=function(){return{__proto__:Ti}.foo===Ti.foo&&!({__proto__:null}instanceof Io)},_o="Function.prototype.bind called on incompatible ",Mo=Object.prototype.toString,Oo=Math.max,Fo="[object Function]",xi=function(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var s=0;s<t.length;s+=1)n[s+e.length]=t[s];return n},Ro=function(e,t){for(var n=[],r=t||0,s=0;r<e.length;r+=1,s+=1)n[s]=e[r];return n},No=function(i,e){for(var t="",n=0;n<i.length;n+=1)t+=i[n],n+1<i.length&&(t+=e);return t},$o=function(e){var t=this;if(typeof t!="function"||Mo.apply(t)!==Fo)throw new TypeError(_o+t);for(var n=Ro(arguments,1),r,s=function(){if(this instanceof r){var h=t.apply(this,xi(n,arguments));return Object(h)===h?h:this}return t.apply(e,xi(n,arguments))},o=Oo(0,t.length-n.length),l=[],u=0;u<o;u++)l[u]="$"+u;if(r=Function("binder","return function ("+No(l,",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var c=function(){};c.prototype=t.prototype,r.prototype=new c,c.prototype=null}return r},Lo=$o,Ze=Function.prototype.bind||Lo,Ho=Function.prototype.call,jo=Object.prototype.hasOwnProperty,Uo=Ze,Ai=Uo.call(Ho,jo),y,Et=SyntaxError,Ii=Function,Dt=TypeError,tn=function(i){try{return Ii('"use strict"; return ('+i+").constructor;")()}catch{}},ft=Object.getOwnPropertyDescriptor;if(ft)try{ft({},"")}catch{ft=null}var en=function(){throw new Dt},Vo=ft?function(){try{return arguments.callee,en}catch{try{return ft(arguments,"callee").get}catch{return en}}}():en,wt=Je(),Go=ko(),B=Object.getPrototypeOf||(Go?function(i){return i.__proto__}:null),Tt={},Ko=typeof Uint8Array>"u"||!B?y:B(Uint8Array),gt={"%AggregateError%":typeof AggregateError>"u"?y:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?y:ArrayBuffer,"%ArrayIteratorPrototype%":wt&&B?B([][Symbol.iterator]()):y,"%AsyncFromSyncIteratorPrototype%":y,"%AsyncFunction%":Tt,"%AsyncGenerator%":Tt,"%AsyncGeneratorFunction%":Tt,"%AsyncIteratorPrototype%":Tt,"%Atomics%":typeof Atomics>"u"?y:Atomics,"%BigInt%":typeof BigInt>"u"?y:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?y:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?y:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?y:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?y:Float32Array,"%Float64Array%":typeof Float64Array>"u"?y:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?y:FinalizationRegistry,"%Function%":Ii,"%GeneratorFunction%":Tt,"%Int8Array%":typeof Int8Array>"u"?y:Int8Array,"%Int16Array%":typeof Int16Array>"u"?y:Int16Array,"%Int32Array%":typeof Int32Array>"u"?y:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":wt&&B?B(B([][Symbol.iterator]())):y,"%JSON%":typeof JSON=="object"?JSON:y,"%Map%":typeof Map>"u"?y:Map,"%MapIteratorPrototype%":typeof Map>"u"||!wt||!B?y:B(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?y:Promise,"%Proxy%":typeof Proxy>"u"?y:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?y:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?y:Set,"%SetIteratorPrototype%":typeof Set>"u"||!wt||!B?y:B(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?y:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":wt&&B?B(""[Symbol.iterator]()):y,"%Symbol%":wt?Symbol:y,"%SyntaxError%":Et,"%ThrowTypeError%":Vo,"%TypedArray%":Ko,"%TypeError%":Dt,"%Uint8Array%":typeof Uint8Array>"u"?y:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?y:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?y:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?y:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?y:WeakMap,"%WeakRef%":typeof WeakRef>"u"?y:WeakRef,"%WeakSet%":typeof WeakSet>"u"?y:WeakSet};if(B)try{null.error}catch(i){var Wo=B(B(i));gt["%Error.prototype%"]=Wo}var zo=function i(e){var t;if(e==="%AsyncFunction%")t=tn("async function () {}");else if(e==="%GeneratorFunction%")t=tn("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=tn("async function* () {}");else if(e==="%AsyncGenerator%"){var n=i("%AsyncGeneratorFunction%");n&&(t=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var r=i("%AsyncGenerator%");r&&B&&(t=B(r.prototype))}return gt[e]=t,t},ki={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Vt=Ze,se=Ai,qo=Vt.call(Function.call,Array.prototype.concat),Xo=Vt.call(Function.apply,Array.prototype.splice),_i=Vt.call(Function.call,String.prototype.replace),oe=Vt.call(Function.call,String.prototype.slice),Yo=Vt.call(Function.call,RegExp.prototype.exec),Qo=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Jo=/\\(\\)?/g,Zo=function(e){var t=oe(e,0,1),n=oe(e,-1);if(t==="%"&&n!=="%")throw new Et("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&t!=="%")throw new Et("invalid intrinsic syntax, expected opening `%`");var r=[];return _i(e,Qo,function(s,o,l,u){r[r.length]=l?_i(u,Jo,"$1"):o||s}),r},ta=function(e,t){var n=e,r;if(se(ki,n)&&(r=ki[n],n="%"+r[0]+"%"),se(gt,n)){var s=gt[n];if(s===Tt&&(s=zo(n)),typeof s>"u"&&!t)throw new Dt("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:s}}throw new Et("intrinsic "+e+" does not exist!")},$=function(e,t){if(typeof e!="string"||e.length===0)throw new Dt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Dt('"allowMissing" argument must be a boolean');if(Yo(/^%?[^%]*%?$/,e)===null)throw new Et("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Zo(e),r=n.length>0?n[0]:"",s=ta("%"+r+"%",t),o=s.name,l=s.value,u=!1,c=s.alias;c&&(r=c[0],Xo(n,qo([0,1],c)));for(var h=1,d=!0;h<n.length;h+=1){var p=n[h],f=oe(p,0,1),v=oe(p,-1);if((f==='"'||f==="'"||f==="`"||v==='"'||v==="'"||v==="`")&&f!==v)throw new Et("property names with quotes must have matching quotes");if((p==="constructor"||!d)&&(u=!0),r+="."+p,o="%"+r+"%",se(gt,o))l=gt[o];else if(l!=null){if(!(p in l)){if(!t)throw new Dt("base intrinsic for "+e+" exists, but the property is not available.");return}if(ft&&h+1>=n.length){var b=ft(l,p);d=!!b,d&&"get"in b&&!("originalValue"in b.get)?l=b.get:l=l[p]}else d=se(l,p),l=l[p];d&&!u&&(gt[o]=l)}}return l},ea=$,nn=ea("%Object.defineProperty%",!0),rn=function(){if(nn)try{return nn({},"a",{value:1}),!0}catch{return!1}return!1};rn.hasArrayLengthDefineBug=function(){if(!rn())return null;try{return nn([],"length",{value:1}).length!==1}catch{return!0}};var ae=rn,na=$,le=na("%Object.getOwnPropertyDescriptor%",!0);if(le)try{le([],"length")}catch{le=null}var sn=le,ia=ae(),on=$,Gt=ia&&on("%Object.defineProperty%",!0);if(Gt)try{Gt({},"a",{value:1})}catch{Gt=!1}var ra=on("%SyntaxError%"),xt=on("%TypeError%"),Mi=sn,an=function(e,t,n){if(!e||typeof e!="object"&&typeof e!="function")throw new xt("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new xt("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new xt("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new xt("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new xt("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new xt("`loose`, if provided, must be a boolean");var r=arguments.length>3?arguments[3]:null,s=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,l=arguments.length>6?arguments[6]:!1,u=!!Mi&&Mi(e,t);if(Gt)Gt(e,t,{configurable:o===null&&u?u.configurable:!o,enumerable:r===null&&u?u.enumerable:!r,value:n,writable:s===null&&u?u.writable:!s});else if(l||!r&&!s&&!o)e[t]=n;else throw new ra("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},sa=Qe,oa=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",aa=Object.prototype.toString,la=Array.prototype.concat,Oi=an,ua=function(i){return typeof i=="function"&&aa.call(i)==="[object Function]"},Fi=ae(),ca=function(i,e,t,n){if(e in i){if(n===!0){if(i[e]===t)return}else if(!ua(n)||!n())return}Fi?Oi(i,e,t,!0):Oi(i,e,t)},Ri=function(i,e){var t=arguments.length>2?arguments[2]:{},n=sa(e);oa&&(n=la.call(n,Object.getOwnPropertySymbols(e)));for(var r=0;r<n.length;r+=1)ca(i,n[r],e[n[r]],t[n[r]])};Ri.supportsDescriptors=!!Fi;var yt=Ri,Ni={exports:{}},$i=$,Li=an,ha=ae(),Hi=sn,ji=$i("%TypeError%"),da=$i("%Math.floor%"),pa=function(e,t){if(typeof e!="function")throw new ji("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||da(t)!==t)throw new ji("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,s=!0;if("length"in e&&Hi){var o=Hi(e,"length");o&&!o.configurable&&(r=!1),o&&!o.writable&&(s=!1)}return(r||s||!n)&&(ha?Li(e,"length",t,!0,!0):Li(e,"length",t)),e};(function(i){var e=Ze,t=$,n=pa,r=t("%TypeError%"),s=t("%Function.prototype.apply%"),o=t("%Function.prototype.call%"),l=t("%Reflect.apply%",!0)||e.call(o,s),u=t("%Object.defineProperty%",!0),c=t("%Math.max%");if(u)try{u({},"a",{value:1})}catch{u=null}i.exports=function(p){if(typeof p!="function")throw new r("a function is required");var f=l(e,o,arguments);return n(f,1+c(0,p.length-(arguments.length-1)),!0)};var h=function(){return l(e,s,arguments)};u?u(i.exports,"apply",{value:h}):i.exports.apply=h})(Ni);var At=Ni.exports,Ui=$,Vi=At,fa=Vi(Ui("String.prototype.indexOf")),L=function(e,t){var n=Ui(e,!!t);return typeof n=="function"&&fa(e,".prototype.")>-1?Vi(n):n},ga=Qe,Gi=re(),Ki=L,Wi=Object,ya=Ki("Array.prototype.push"),zi=Ki("Object.prototype.propertyIsEnumerable"),va=Gi?Object.getOwnPropertySymbols:null,qi=function(e,t){if(e==null)throw new TypeError("target must be an object");var n=Wi(e);if(arguments.length===1)return n;for(var r=1;r<arguments.length;++r){var s=Wi(arguments[r]),o=ga(s),l=Gi&&(Object.getOwnPropertySymbols||va);if(l)for(var u=l(s),c=0;c<u.length;++c){var h=u[c];zi(s,h)&&ya(o,h)}for(var d=0;d<o.length;++d){var p=o[d];if(zi(s,p)){var f=s[p];n[p]=f}}}return n},ln=qi,ma=function(){if(!Object.assign)return!1;for(var i="abcdefghijklmnopqrst",e=i.split(""),t={},n=0;n<e.length;++n)t[e[n]]=e[n];var r=Object.assign({},t),s="";for(var o in r)s+=o;return i!==s},Sa=function(){if(!Object.assign||!Object.preventExtensions)return!1;var i=Object.preventExtensions({1:2});try{Object.assign(i,"xy")}catch{return i[1]==="y"}return!1},Xi=function(){return!Object.assign||ma()||Sa()?ln:Object.assign},ba=yt,Ca=Xi,Ba=function(){var e=Ca();return ba(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e},Pa=yt,Ea=At,Da=qi,Yi=Xi,wa=Ba,Ta=Ea.apply(Yi()),Qi=function(e,t){return Ta(Object,arguments)};Pa(Qi,{getPolyfill:Yi,implementation:Da,shim:wa});var xa=Qi,Kt=function(){return typeof(function(){}).name=="string"},Wt=Object.getOwnPropertyDescriptor;if(Wt)try{Wt([],"length")}catch{Wt=null}Kt.functionsHaveConfigurableNames=function(){if(!Kt()||!Wt)return!1;var e=Wt(function(){},"name");return!!e&&!!e.configurable};var Aa=Function.prototype.bind;Kt.boundFunctionsHaveNames=function(){return Kt()&&typeof Aa=="function"&&(function(){}).bind().name!==""};var Ia=Kt,Ji=an,ka=ae(),_a=Ia.functionsHaveConfigurableNames(),Ma=TypeError,Oa=function(e,t){if(typeof e!="function")throw new Ma("`fn` is not a function");var n=arguments.length>2&&!!arguments[2];return(!n||_a)&&(ka?Ji(e,"name",t,!0,!0):Ji(e,"name",t)),e},Fa=Oa,Ra=Object,Na=TypeError,Zi=Fa(function(){if(this!=null&&this!==Ra(this))throw new Na("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.unicodeSets&&(e+="v"),this.sticky&&(e+="y"),e},"get flags",!0),$a=Zi,La=yt.supportsDescriptors,Ha=Object.getOwnPropertyDescriptor,tr=function(){if(La&&/a/mig.flags==="gim"){var e=Ha(RegExp.prototype,"flags");if(e&&typeof e.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var t="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(n,"sticky",{get:function(){t+="y"}}),t==="dy")return e.get}}return $a},ja=yt.supportsDescriptors,Ua=tr,Va=Object.getOwnPropertyDescriptor,Ga=Object.defineProperty,Ka=TypeError,er=Object.getPrototypeOf,Wa=/a/,za=function(){if(!ja||!er)throw new Ka("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=Ua(),t=er(Wa),n=Va(t,"flags");return(!n||n.get!==e)&&Ga(t,"flags",{configurable:!0,enumerable:!1,get:e}),e},qa=yt,Xa=At,Ya=Zi,nr=tr,Qa=za,ir=Xa(nr());qa(ir,{getPolyfill:nr,implementation:Ya,shim:Qa});var Ja=ir,ue={exports:{}},Za=re,vt=function(){return Za()&&!!Symbol.toStringTag},tl=vt(),el=L,un=el("Object.prototype.toString"),ce=function(e){return tl&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:un(e)==="[object Arguments]"},rr=function(e){return ce(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&un(e)!=="[object Array]"&&un(e.callee)==="[object Function]"},nl=function(){return ce(arguments)}();ce.isLegacyArguments=rr;var sr=nl?ce:rr;const il=mo(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var cn=typeof Map=="function"&&Map.prototype,hn=Object.getOwnPropertyDescriptor&&cn?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,he=cn&&hn&&typeof hn.get=="function"?hn.get:null,or=cn&&Map.prototype.forEach,dn=typeof Set=="function"&&Set.prototype,pn=Object.getOwnPropertyDescriptor&&dn?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,de=dn&&pn&&typeof pn.get=="function"?pn.get:null,ar=dn&&Set.prototype.forEach,rl=typeof WeakMap=="function"&&WeakMap.prototype,zt=rl?WeakMap.prototype.has:null,sl=typeof WeakSet=="function"&&WeakSet.prototype,qt=sl?WeakSet.prototype.has:null,ol=typeof WeakRef=="function"&&WeakRef.prototype,lr=ol?WeakRef.prototype.deref:null,al=Boolean.prototype.valueOf,ll=Object.prototype.toString,ul=Function.prototype.toString,cl=String.prototype.match,fn=String.prototype.slice,ut=String.prototype.replace,hl=String.prototype.toUpperCase,ur=String.prototype.toLowerCase,cr=RegExp.prototype.test,hr=Array.prototype.concat,Q=Array.prototype.join,dl=Array.prototype.slice,dr=Math.floor,gn=typeof BigInt=="function"?BigInt.prototype.valueOf:null,yn=Object.getOwnPropertySymbols,vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,It=typeof Symbol=="function"&&typeof Symbol.iterator=="object",T=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===It||!0)?Symbol.toStringTag:null,pr=Object.prototype.propertyIsEnumerable,fr=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(i){return i.__proto__}:null);function gr(i,e){if(i===1/0||i===-1/0||i!==i||i&&i>-1e3&&i<1e3||cr.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof i=="number"){var n=i<0?-dr(-i):dr(i);if(n!==i){var r=String(n),s=fn.call(e,r.length+1);return ut.call(r,t,"$&_")+"."+ut.call(ut.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ut.call(e,t,"$&_")}var mn=il,yr=mn.custom,vr=br(yr)?yr:null,pl=function i(e,t,n,r){var s=t||{};if(ct(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(ct(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=ct(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(ct(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(ct(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var l=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return Br(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var u=String(e);return l?gr(e,u):u}if(typeof e=="bigint"){var c=String(e)+"n";return l?gr(e,c):c}var h=typeof s.depth>"u"?5:s.depth;if(typeof n>"u"&&(n=0),n>=h&&h>0&&typeof e=="object")return Sn(e)?"[Array]":"[Object]";var d=kl(s,n);if(typeof r>"u")r=[];else if(Cr(r,e)>=0)return"[Circular]";function p(Ut,Ke,Ud){if(Ke&&(r=dl.call(r),r.push(Ke)),Ud){var vo={depth:s.depth};return ct(s,"quoteStyle")&&(vo.quoteStyle=s.quoteStyle),i(Ut,vo,n+1,r)}return i(Ut,s,n+1,r)}if(typeof e=="function"&&!Sr(e)){var f=Bl(e),v=pe(e,p);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(v.length>0?" { "+Q.call(v,", ")+" }":"")}if(br(e)){var b=It?ut.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):vn.call(e);return typeof e=="object"&&!It?Xt(b):b}if(xl(e)){for(var g="<"+ur.call(String(e.nodeName)),D=e.attributes||[],C=0;C<D.length;C++)g+=" "+D[C].name+"="+mr(fl(D[C].value),"double",s);return g+=">",e.childNodes&&e.childNodes.length&&(g+="..."),g+="</"+ur.call(String(e.nodeName))+">",g}if(Sn(e)){if(e.length===0)return"[]";var S=pe(e,p);return d&&!Il(S)?"["+Cn(S,d)+"]":"[ "+Q.call(S,", ")+" ]"}if(yl(e)){var V=pe(e,p);return!("cause"in Error.prototype)&&"cause"in e&&!pr.call(e,"cause")?"{ ["+String(e)+"] "+Q.call(hr.call("[cause]: "+p(e.cause),V),", ")+" }":V.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Q.call(V,", ")+" }"}if(typeof e=="object"&&o){if(vr&&typeof e[vr]=="function"&&mn)return mn(e,{depth:h-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Pl(e)){var A=[];return or&&or.call(e,function(Ut,Ke){A.push(p(Ke,e,!0)+" => "+p(Ut,e))}),Pr("Map",he.call(e),A,d)}if(wl(e)){var N=[];return ar&&ar.call(e,function(Ut){N.push(p(Ut,e))}),Pr("Set",de.call(e),N,d)}if(El(e))return bn("WeakMap");if(Tl(e))return bn("WeakSet");if(Dl(e))return bn("WeakRef");if(ml(e))return Xt(p(Number(e)));if(bl(e))return Xt(p(gn.call(e)));if(Sl(e))return Xt(al.call(e));if(vl(e))return Xt(p(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===x)return"{ [object globalThis] }";if(!gl(e)&&!Sr(e)){var at=pe(e,p),G=fr?fr(e)===Object.prototype:e instanceof Object||e.constructor===Object,jt=e instanceof Object?"":"null prototype",yo=!G&&T&&Object(e)===e&&T in e?fn.call(ht(e),8,-1):jt?"Object":"",jd=G||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",mi=jd+(yo||jt?"["+Q.call(hr.call([],yo||[],jt||[]),": ")+"] ":"");return at.length===0?mi+"{}":d?mi+"{"+Cn(at,d)+"}":mi+"{ "+Q.call(at,", ")+" }"}return String(e)};function mr(i,e,t){var n=(t.quoteStyle||e)==="double"?'"':"'";return n+i+n}function fl(i){return ut.call(String(i),/"/g,"&quot;")}function Sn(i){return ht(i)==="[object Array]"&&(!T||!(typeof i=="object"&&T in i))}function gl(i){return ht(i)==="[object Date]"&&(!T||!(typeof i=="object"&&T in i))}function Sr(i){return ht(i)==="[object RegExp]"&&(!T||!(typeof i=="object"&&T in i))}function yl(i){return ht(i)==="[object Error]"&&(!T||!(typeof i=="object"&&T in i))}function vl(i){return ht(i)==="[object String]"&&(!T||!(typeof i=="object"&&T in i))}function ml(i){return ht(i)==="[object Number]"&&(!T||!(typeof i=="object"&&T in i))}function Sl(i){return ht(i)==="[object Boolean]"&&(!T||!(typeof i=="object"&&T in i))}function br(i){if(It)return i&&typeof i=="object"&&i instanceof Symbol;if(typeof i=="symbol")return!0;if(!i||typeof i!="object"||!vn)return!1;try{return vn.call(i),!0}catch{}return!1}function bl(i){if(!i||typeof i!="object"||!gn)return!1;try{return gn.call(i),!0}catch{}return!1}var Cl=Object.prototype.hasOwnProperty||function(i){return i in this};function ct(i,e){return Cl.call(i,e)}function ht(i){return ll.call(i)}function Bl(i){if(i.name)return i.name;var e=cl.call(ul.call(i),/^function\s*([\w$]+)/);return e?e[1]:null}function Cr(i,e){if(i.indexOf)return i.indexOf(e);for(var t=0,n=i.length;t<n;t++)if(i[t]===e)return t;return-1}function Pl(i){if(!he||!i||typeof i!="object")return!1;try{he.call(i);try{de.call(i)}catch{return!0}return i instanceof Map}catch{}return!1}function El(i){if(!zt||!i||typeof i!="object")return!1;try{zt.call(i,zt);try{qt.call(i,qt)}catch{return!0}return i instanceof WeakMap}catch{}return!1}function Dl(i){if(!lr||!i||typeof i!="object")return!1;try{return lr.call(i),!0}catch{}return!1}function wl(i){if(!de||!i||typeof i!="object")return!1;try{de.call(i);try{he.call(i)}catch{return!0}return i instanceof Set}catch{}return!1}function Tl(i){if(!qt||!i||typeof i!="object")return!1;try{qt.call(i,qt);try{zt.call(i,zt)}catch{return!0}return i instanceof WeakSet}catch{}return!1}function xl(i){return!i||typeof i!="object"?!1:typeof HTMLElement<"u"&&i instanceof HTMLElement?!0:typeof i.nodeName=="string"&&typeof i.getAttribute=="function"}function Br(i,e){if(i.length>e.maxStringLength){var t=i.length-e.maxStringLength,n="... "+t+" more character"+(t>1?"s":"");return Br(fn.call(i,0,e.maxStringLength),e)+n}var r=ut.call(ut.call(i,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Al);return mr(r,"single",e)}function Al(i){var e=i.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+hl.call(e.toString(16))}function Xt(i){return"Object("+i+")"}function bn(i){return i+" { ? }"}function Pr(i,e,t,n){var r=n?Cn(t,n):Q.call(t,", ");return i+" ("+e+") {"+r+"}"}function Il(i){for(var e=0;e<i.length;e++)if(Cr(i[e],`
`)>=0)return!1;return!0}function kl(i,e){var t;if(i.indent==="	")t="	";else if(typeof i.indent=="number"&&i.indent>0)t=Q.call(Array(i.indent+1)," ");else return null;return{base:t,prev:Q.call(Array(e+1),t)}}function Cn(i,e){if(i.length===0)return"";var t=`
`+e.prev+e.base;return t+Q.call(i,","+t)+`
`+e.prev}function pe(i,e){var t=Sn(i),n=[];if(t){n.length=i.length;for(var r=0;r<i.length;r++)n[r]=ct(i,r)?e(i[r],i):""}var s=typeof yn=="function"?yn(i):[],o;if(It){o={};for(var l=0;l<s.length;l++)o["$"+s[l]]=s[l]}for(var u in i)ct(i,u)&&(t&&String(Number(u))===u&&u<i.length||It&&o["$"+u]instanceof Symbol||(cr.call(/[^\w$]/,u)?n.push(e(u,i)+": "+e(i[u],i)):n.push(u+": "+e(i[u],i))));if(typeof yn=="function")for(var c=0;c<s.length;c++)pr.call(i,s[c])&&n.push("["+e(s[c])+"]: "+e(i[s[c]],i));return n}var Bn=$,kt=L,_l=pl,Ml=Bn("%TypeError%"),fe=Bn("%WeakMap%",!0),ge=Bn("%Map%",!0),Ol=kt("WeakMap.prototype.get",!0),Fl=kt("WeakMap.prototype.set",!0),Rl=kt("WeakMap.prototype.has",!0),Nl=kt("Map.prototype.get",!0),$l=kt("Map.prototype.set",!0),Ll=kt("Map.prototype.has",!0),Pn=function(i,e){for(var t=i,n;(n=t.next)!==null;t=n)if(n.key===e)return t.next=n.next,n.next=i.next,i.next=n,n},Hl=function(i,e){var t=Pn(i,e);return t&&t.value},jl=function(i,e,t){var n=Pn(i,e);n?n.value=t:i.next={key:e,next:i.next,value:t}},Ul=function(i,e){return!!Pn(i,e)},Er=function(){var e,t,n,r={assert:function(s){if(!r.has(s))throw new Ml("Side channel does not contain "+_l(s))},get:function(s){if(fe&&s&&(typeof s=="object"||typeof s=="function")){if(e)return Ol(e,s)}else if(ge){if(t)return Nl(t,s)}else if(n)return Hl(n,s)},has:function(s){if(fe&&s&&(typeof s=="object"||typeof s=="function")){if(e)return Rl(e,s)}else if(ge){if(t)return Ll(t,s)}else if(n)return Ul(n,s);return!1},set:function(s,o){fe&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new fe),Fl(e,s,o)):ge?(t||(t=new ge),$l(t,s,o)):(n||(n={key:{},next:null}),jl(n,s,o))}};return r},Vl=$,Gl=Ai,Yt=Er(),nt=Vl("%TypeError%"),En={assert:function(i,e){if(!i||typeof i!="object"&&typeof i!="function")throw new nt("`O` is not an object");if(typeof e!="string")throw new nt("`slot` must be a string");if(Yt.assert(i),!En.has(i,e))throw new nt("`"+e+"` is not present on `O`")},get:function(i,e){if(!i||typeof i!="object"&&typeof i!="function")throw new nt("`O` is not an object");if(typeof e!="string")throw new nt("`slot` must be a string");var t=Yt.get(i);return t&&t["$"+e]},has:function(i,e){if(!i||typeof i!="object"&&typeof i!="function")throw new nt("`O` is not an object");if(typeof e!="string")throw new nt("`slot` must be a string");var t=Yt.get(i);return!!t&&Gl(t,"$"+e)},set:function(i,e,t){if(!i||typeof i!="object"&&typeof i!="function")throw new nt("`O` is not an object");if(typeof e!="string")throw new nt("`slot` must be a string");var n=Yt.get(i);n||(n={},Yt.set(i,n)),n["$"+e]=t}};Object.freeze&&Object.freeze(En);var Kl=En,Qt=Kl,Wl=SyntaxError,Dr=typeof StopIteration=="object"?StopIteration:null,zl=function(e){if(!Dr)throw new Wl("this environment lacks StopIteration");Qt.set(e,"[[Done]]",!1);var t={next:function(){var r=Qt.get(this,"[[Iterator]]"),s=Qt.get(r,"[[Done]]");try{return{done:s,value:s?void 0:r.next()}}catch(o){if(Qt.set(r,"[[Done]]",!0),o!==Dr)throw o;return{done:!0,value:void 0}}}};return Qt.set(t,"[[Iterator]]",e),t},ql={}.toString,wr=Array.isArray||function(i){return ql.call(i)=="[object Array]"},Xl=String.prototype.valueOf,Yl=function(e){try{return Xl.call(e),!0}catch{return!1}},Ql=Object.prototype.toString,Jl="[object String]",Zl=vt(),Tr=function(e){return typeof e=="string"?!0:typeof e!="object"?!1:Zl?Yl(e):Ql.call(e)===Jl},Dn=typeof Map=="function"&&Map.prototype?Map:null,tu=typeof Set=="function"&&Set.prototype?Set:null,ye;Dn||(ye=function(e){return!1});var xr=Dn?Map.prototype.has:null,Ar=tu?Set.prototype.has:null;!ye&&!xr&&(ye=function(e){return!1});var Ir=ye||function(e){if(!e||typeof e!="object")return!1;try{if(xr.call(e),Ar)try{Ar.call(e)}catch{return!0}return e instanceof Dn}catch{}return!1},eu=typeof Map=="function"&&Map.prototype?Map:null,wn=typeof Set=="function"&&Set.prototype?Set:null,ve;wn||(ve=function(e){return!1});var kr=eu?Map.prototype.has:null,_r=wn?Set.prototype.has:null;!ve&&!_r&&(ve=function(e){return!1});var Mr=ve||function(e){if(!e||typeof e!="object")return!1;try{if(_r.call(e),kr)try{kr.call(e)}catch{return!0}return e instanceof wn}catch{}return!1},Or=sr,Fr=zl;if(Je()||re()){var Tn=Symbol.iterator;ue.exports=function(e){if(e!=null&&typeof e[Tn]<"u")return e[Tn]();if(Or(e))return Array.prototype[Tn].call(e)}}else{var nu=wr,iu=Tr,Rr=$,ru=Rr("%Map%",!0),su=Rr("%Set%",!0),K=L,Nr=K("Array.prototype.push"),$r=K("String.prototype.charCodeAt"),ou=K("String.prototype.slice"),au=function(e,t){var n=e.length;if(t+1>=n)return t+1;var r=$r(e,t);if(r<55296||r>56319)return t+1;var s=$r(e,t+1);return s<56320||s>57343?t+1:t+2},xn=function(e){var t=0;return{next:function(){var r=t>=e.length,s;return r||(s=e[t],t+=1),{done:r,value:s}}}},Lr=function(e,t){if(nu(e)||Or(e))return xn(e);if(iu(e)){var n=0;return{next:function(){var s=au(e,n),o=ou(e,n,s);return n=s,{done:s>e.length,value:o}}}}if(t&&typeof e["_es6-shim iterator_"]<"u")return e["_es6-shim iterator_"]()};if(!ru&&!su)ue.exports=function(e){if(e!=null)return Lr(e,!0)};else{var lu=Ir,uu=Mr,Hr=K("Map.prototype.forEach",!0),jr=K("Set.prototype.forEach",!0);if(typeof process>"u"||!process.versions||!process.versions.node)var Ur=K("Map.prototype.iterator",!0),Vr=K("Set.prototype.iterator",!0);var Gr=K("Map.prototype.@@iterator",!0)||K("Map.prototype._es6-shim iterator_",!0),Kr=K("Set.prototype.@@iterator",!0)||K("Set.prototype._es6-shim iterator_",!0),cu=function(e){if(lu(e)){if(Ur)return Fr(Ur(e));if(Gr)return Gr(e);if(Hr){var t=[];return Hr(e,function(r,s){Nr(t,[s,r])}),xn(t)}}if(uu(e)){if(Vr)return Fr(Vr(e));if(Kr)return Kr(e);if(jr){var n=[];return jr(e,function(r){Nr(n,r)}),xn(n)}}};ue.exports=function(e){return cu(e)||Lr(e)}}}var hu=ue.exports,Wr=function(i){return i!==i},zr=function(e,t){return e===0&&t===0?1/e===1/t:!!(e===t||Wr(e)&&Wr(t))},du=zr,qr=function(){return typeof Object.is=="function"?Object.is:du},pu=qr,fu=yt,gu=function(){var e=pu();return fu(Object,{is:e},{is:function(){return Object.is!==e}}),e},yu=yt,vu=At,mu=zr,Xr=qr,Su=gu,Yr=vu(Xr(),Object);yu(Yr,{getPolyfill:Xr,implementation:mu,shim:Su});var bu=Yr,Qr=Function.prototype.toString,_t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,An,me;if(typeof _t=="function"&&typeof Object.defineProperty=="function")try{An=Object.defineProperty({},"length",{get:function(){throw me}}),me={},_t(function(){throw 42},null,An)}catch(i){i!==me&&(_t=null)}else _t=null;var Cu=/^\s*class\b/,In=function(e){try{var t=Qr.call(e);return Cu.test(t)}catch{return!1}},kn=function(e){try{return In(e)?!1:(Qr.call(e),!0)}catch{return!1}},Se=Object.prototype.toString,Bu="[object Object]",Pu="[object Function]",Eu="[object GeneratorFunction]",Du="[object HTMLAllCollection]",wu="[object HTML document.all class]",Tu="[object HTMLCollection]",xu=typeof Symbol=="function"&&!!Symbol.toStringTag,Au=!(0 in[,]),_n=function(){return!1};if(typeof document=="object"){var Iu=document.all;Se.call(Iu)===Se.call(document.all)&&(_n=function(e){if((Au||!e)&&(typeof e>"u"||typeof e=="object"))try{var t=Se.call(e);return(t===Du||t===wu||t===Tu||t===Bu)&&e("")==null}catch{}return!1})}var ku=_t?function(e){if(_n(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{_t(e,null,An)}catch(t){if(t!==me)return!1}return!In(e)&&kn(e)}:function(e){if(_n(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(xu)return kn(e);if(In(e))return!1;var t=Se.call(e);return t!==Pu&&t!==Eu&&!/^\[object HTML/.test(t)?!1:kn(e)},_u=ku,Mu=Object.prototype.toString,Jr=Object.prototype.hasOwnProperty,Ou=function(e,t,n){for(var r=0,s=e.length;r<s;r++)Jr.call(e,r)&&(n==null?t(e[r],r,e):t.call(n,e[r],r,e))},Fu=function(e,t,n){for(var r=0,s=e.length;r<s;r++)n==null?t(e.charAt(r),r,e):t.call(n,e.charAt(r),r,e)},Ru=function(e,t,n){for(var r in e)Jr.call(e,r)&&(n==null?t(e[r],r,e):t.call(n,e[r],r,e))},Nu=function(e,t,n){if(!_u(t))throw new TypeError("iterator must be a function");var r;arguments.length>=3&&(r=n),Mu.call(e)==="[object Array]"?Ou(e,t,r):typeof e=="string"?Fu(e,t,r):Ru(e,t,r)},$u=Nu,Mn=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],Lu=typeof globalThis>"u"?x:globalThis,Hu=function(){for(var e=[],t=0;t<Mn.length;t++)typeof Lu[Mn[t]]=="function"&&(e[e.length]=Mn[t]);return e},be=$u,ju=Hu,Zr=At,On=L,Ce=sn,Uu=On("Object.prototype.toString"),ts=vt(),es=typeof globalThis>"u"?x:globalThis,Fn=ju(),Rn=On("String.prototype.slice"),Nn=Object.getPrototypeOf,Vu=On("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},Be={__proto__:null};ts&&Ce&&Nn?be(Fn,function(i){var e=new es[i];if(Symbol.toStringTag in e){var t=Nn(e),n=Ce(t,Symbol.toStringTag);if(!n){var r=Nn(t);n=Ce(r,Symbol.toStringTag)}Be["$"+i]=Zr(n.get)}}):be(Fn,function(i){var e=new es[i],t=e.slice||e.set;t&&(Be["$"+i]=Zr(t))});var Gu=function(e){var t=!1;return be(Be,function(n,r){if(!t)try{"$"+n(e)===r&&(t=Rn(r,1))}catch{}}),t},Ku=function(e){var t=!1;return be(Be,function(n,r){if(!t)try{n(e),t=Rn(r,1)}catch{}}),t},ns=function(e){if(!e||typeof e!="object")return!1;if(!ts){var t=Rn(Uu(e),8,-1);return Vu(Fn,t)>-1?t:t!=="Object"?!1:Ku(e)}return Ce?Gu(e):null},Wu=ns,zu=function(e){return!!Wu(e)},qu=At,Xu=L,is=$,Yu=zu,rs=is("ArrayBuffer",!0),ss=is("Float32Array",!0),Pe=Xu("ArrayBuffer.prototype.byteLength",!0),os=rs&&!Pe&&new rs().slice,as=os&&qu(os),ls=Pe||as?function(e){if(!e||typeof e!="object")return!1;try{return Pe?Pe(e):as(e,0),!0}catch{return!1}}:ss?function(e){try{return new ss(e).buffer===e&&!Yu(e)}catch(t){return typeof e=="object"&&t.name==="RangeError"}}:function(e){return!1},Qu=Date.prototype.getDay,Ju=function(e){try{return Qu.call(e),!0}catch{return!1}},Zu=Object.prototype.toString,tc="[object Date]",ec=vt(),nc=function(e){return typeof e!="object"||e===null?!1:ec?Ju(e):Zu.call(e)===tc},$n=L,us=vt(),cs,hs,Ln,Hn;if(us){cs=$n("Object.prototype.hasOwnProperty"),hs=$n("RegExp.prototype.exec"),Ln={};var jn=function(){throw Ln};Hn={toString:jn,valueOf:jn},typeof Symbol.toPrimitive=="symbol"&&(Hn[Symbol.toPrimitive]=jn)}var ic=$n("Object.prototype.toString"),rc=Object.getOwnPropertyDescriptor,sc="[object RegExp]",oc=us?function(e){if(!e||typeof e!="object")return!1;var t=rc(e,"lastIndex"),n=t&&cs(t,"value");if(!n)return!1;try{hs(e,Hn)}catch(r){return r===Ln}}:function(e){return!e||typeof e!="object"&&typeof e!="function"?!1:ic(e)===sc},ac=L,ds=ac("SharedArrayBuffer.prototype.byteLength",!0),lc=ds?function(e){if(!e||typeof e!="object")return!1;try{return ds(e),!0}catch{return!1}}:function(e){return!1},uc=Number.prototype.toString,cc=function(e){try{return uc.call(e),!0}catch{return!1}},hc=Object.prototype.toString,dc="[object Number]",pc=vt(),fc=function(e){return typeof e=="number"?!0:typeof e!="object"?!1:pc?cc(e):hc.call(e)===dc},ps=L,gc=ps("Boolean.prototype.toString"),yc=ps("Object.prototype.toString"),vc=function(e){try{return gc(e),!0}catch{return!1}},mc="[object Boolean]",Sc=vt(),bc=function(e){return typeof e=="boolean"?!0:e===null||typeof e!="object"?!1:Sc&&Symbol.toStringTag in e?vc(e):yc(e)===mc},Un={exports:{}},Cc=Object.prototype.toString,Bc=Je();if(Bc){var Pc=Symbol.prototype.toString,Ec=/^Symbol\(.*\)$/,Dc=function(e){return typeof e.valueOf()!="symbol"?!1:Ec.test(Pc.call(e))};Un.exports=function(e){if(typeof e=="symbol")return!0;if(Cc.call(e)!=="[object Symbol]")return!1;try{return Dc(e)}catch{return!1}}}else Un.exports=function(e){return!1};var wc=Un.exports,Vn={exports:{}},fs=typeof BigInt<"u"&&BigInt,Tc=function(){return typeof fs=="function"&&typeof BigInt=="function"&&typeof fs(42)=="bigint"&&typeof BigInt(42)=="bigint"},xc=Tc();if(xc){var Ac=BigInt.prototype.valueOf,Ic=function(e){try{return Ac.call(e),!0}catch{}return!1};Vn.exports=function(e){return e===null||typeof e>"u"||typeof e=="boolean"||typeof e=="string"||typeof e=="number"||typeof e=="symbol"||typeof e=="function"?!1:typeof e=="bigint"?!0:Ic(e)}}else Vn.exports=function(e){return!1};var kc=Vn.exports,_c=Tr,Mc=fc,Oc=bc,Fc=wc,Rc=kc,Nc=function(e){if(e==null||typeof e!="object"&&typeof e!="function")return null;if(_c(e))return"String";if(Mc(e))return"Number";if(Oc(e))return"Boolean";if(Fc(e))return"Symbol";if(Rc(e))return"BigInt"},Ee=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,gs=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,De;Ee||(De=function(e){return!1});var Gn=Ee?Ee.prototype.has:null,Kn=gs?gs.prototype.has:null;!De&&!Gn&&(De=function(e){return!1});var $c=De||function(e){if(!e||typeof e!="object")return!1;try{if(Gn.call(e,Gn),Kn)try{Kn.call(e,Kn)}catch{return!0}return e instanceof Ee}catch{}return!1},Wn={exports:{}},Lc=$,ys=L,Hc=Lc("%WeakSet%",!0),zn=ys("WeakSet.prototype.has",!0);if(zn){var qn=ys("WeakMap.prototype.has",!0);Wn.exports=function(e){if(!e||typeof e!="object")return!1;try{if(zn(e,zn),qn)try{qn(e,qn)}catch{return!0}return e instanceof Hc}catch{}return!1}}else Wn.exports=function(e){return!1};var jc=Wn.exports,Uc=Ir,Vc=Mr,Gc=$c,Kc=jc,Wc=function(e){if(e&&typeof e=="object"){if(Uc(e))return"Map";if(Vc(e))return"Set";if(Gc(e))return"WeakMap";if(Kc(e))return"WeakSet"}return!1},zc=L,vs=zc("ArrayBuffer.prototype.byteLength",!0),qc=ls,Xc=function(e){return qc(e)?vs?vs(e):e.byteLength:NaN},ms=xa,J=L,Ss=Ja,Yc=$,Mt=hu,Qc=Er,bs=bu,Cs=sr,Bs=wr,Ps=ls,Es=nc,Ds=oc,ws=lc,Ts=Qe,xs=Nc,As=Wc,Is=ns,ks=Xc,_s=J("SharedArrayBuffer.prototype.byteLength",!0),Ms=J("Date.prototype.getTime"),Xn=Object.getPrototypeOf,Os=J("Object.prototype.toString"),we=Yc("%Set%",!0),Yn=J("Map.prototype.has",!0),Te=J("Map.prototype.get",!0),Fs=J("Map.prototype.size",!0),xe=J("Set.prototype.add",!0),Rs=J("Set.prototype.delete",!0),Ae=J("Set.prototype.has",!0),Ie=J("Set.prototype.size",!0);function Ns(i,e,t,n){for(var r=Mt(i),s;(s=r.next())&&!s.done;)if(W(e,s.value,t,n))return Rs(i,s.value),!0;return!1}function $s(i){if(typeof i>"u")return null;if(typeof i!="object")return typeof i=="symbol"?!1:typeof i=="string"||typeof i=="number"?+i==+i:!0}function Jc(i,e,t,n,r,s){var o=$s(t);if(o!=null)return o;var l=Te(e,o),u=ms({},r,{strict:!1});return typeof l>"u"&&!Yn(e,o)||!W(n,l,u,s)?!1:!Yn(i,o)&&W(n,l,u,s)}function Zc(i,e,t){var n=$s(t);return n??(Ae(e,n)&&!Ae(i,n))}function Ls(i,e,t,n,r,s){for(var o=Mt(i),l,u;(l=o.next())&&!l.done;)if(u=l.value,W(t,u,r,s)&&W(n,Te(e,u),r,s))return Rs(i,u),!0;return!1}function W(i,e,t,n){var r=t||{};if(r.strict?bs(i,e):i===e)return!0;var s=xs(i),o=xs(e);if(s!==o)return!1;if(!i||!e||typeof i!="object"&&typeof e!="object")return r.strict?bs(i,e):i==e;var l=n.has(i),u=n.has(e),c;if(l&&u){if(n.get(i)===n.get(e))return!0}else c={};return l||n.set(i,c),u||n.set(e,c),nh(i,e,r,n)}function Hs(i){return!i||typeof i!="object"||typeof i.length!="number"||typeof i.copy!="function"||typeof i.slice!="function"||i.length>0&&typeof i[0]!="number"?!1:!!(i.constructor&&i.constructor.isBuffer&&i.constructor.isBuffer(i))}function th(i,e,t,n){if(Ie(i)!==Ie(e))return!1;for(var r=Mt(i),s=Mt(e),o,l,u;(o=r.next())&&!o.done;)if(o.value&&typeof o.value=="object")u||(u=new we),xe(u,o.value);else if(!Ae(e,o.value)){if(t.strict||!Zc(i,e,o.value))return!1;u||(u=new we),xe(u,o.value)}if(u){for(;(l=s.next())&&!l.done;)if(l.value&&typeof l.value=="object"){if(!Ns(u,l.value,t.strict,n))return!1}else if(!t.strict&&!Ae(i,l.value)&&!Ns(u,l.value,t.strict,n))return!1;return Ie(u)===0}return!0}function eh(i,e,t,n){if(Fs(i)!==Fs(e))return!1;for(var r=Mt(i),s=Mt(e),o,l,u,c,h,d;(o=r.next())&&!o.done;)if(c=o.value[0],h=o.value[1],c&&typeof c=="object")u||(u=new we),xe(u,c);else if(d=Te(e,c),typeof d>"u"&&!Yn(e,c)||!W(h,d,t,n)){if(t.strict||!Jc(i,e,c,h,t,n))return!1;u||(u=new we),xe(u,c)}if(u){for(;(l=s.next())&&!l.done;)if(c=l.value[0],d=l.value[1],c&&typeof c=="object"){if(!Ls(u,i,c,d,t,n))return!1}else if(!t.strict&&(!i.has(c)||!W(Te(i,c),d,t,n))&&!Ls(u,i,c,d,ms({},t,{strict:!1}),n))return!1;return Ie(u)===0}return!0}function nh(i,e,t,n){var r,s;if(typeof i!=typeof e||i==null||e==null||Os(i)!==Os(e)||Cs(i)!==Cs(e))return!1;var o=Bs(i),l=Bs(e);if(o!==l)return!1;var u=i instanceof Error,c=e instanceof Error;if(u!==c||(u||c)&&(i.name!==e.name||i.message!==e.message))return!1;var h=Ds(i),d=Ds(e);if(h!==d||(h||d)&&(i.source!==e.source||Ss(i)!==Ss(e)))return!1;var p=Es(i),f=Es(e);if(p!==f||(p||f)&&Ms(i)!==Ms(e)||t.strict&&Xn&&Xn(i)!==Xn(e))return!1;var v=Is(i),b=Is(e);if(v!==b)return!1;if(v||b){if(i.length!==e.length)return!1;for(r=0;r<i.length;r++)if(i[r]!==e[r])return!1;return!0}var g=Hs(i),D=Hs(e);if(g!==D)return!1;if(g||D){if(i.length!==e.length)return!1;for(r=0;r<i.length;r++)if(i[r]!==e[r])return!1;return!0}var C=Ps(i),S=Ps(e);if(C!==S)return!1;if(C||S)return ks(i)!==ks(e)?!1:typeof Uint8Array=="function"&&W(new Uint8Array(i),new Uint8Array(e),t,n);var V=ws(i),A=ws(e);if(V!==A)return!1;if(V||A)return _s(i)!==_s(e)?!1:typeof Uint8Array=="function"&&W(new Uint8Array(i),new Uint8Array(e),t,n);if(typeof i!=typeof e)return!1;var N=Ts(i),at=Ts(e);if(N.length!==at.length)return!1;for(N.sort(),at.sort(),r=N.length-1;r>=0;r--)if(N[r]!=at[r])return!1;for(r=N.length-1;r>=0;r--)if(s=N[r],!W(i[s],e[s],t,n))return!1;var G=As(i),jt=As(e);return G!==jt?!1:G==="Set"||jt==="Set"?th(i,e,t,n):G==="Map"?eh(i,e,t,n):!0}var ih=function(e,t,n){return W(e,t,n,Qc())};const rh=lt(ih);function Ot(i,e=!1){switch(typeof i){case"boolean":return i;case"number":return i!==0;case"string":switch(i.toLocaleLowerCase()){case"true":return!0;case"false":case"":return!1;default:{const t=Number.parseFloat(i);return Number.isNaN(t)?e:t!==0}}default:return e}}function sh(i){let e;try{if(e=JSON.parse(i),!O(e))return}catch(t){console.warn(t);return}return e}function Ft(i){switch(typeof i){case"number":return Number.isFinite(i);case"string":return Ft(Number.parseFloat(i));default:return!1}}function R(i,e,t){return Ft(i)||(i=0),Ft(e)||(e=Number.MIN_SAFE_INTEGER),Ft(t)||(t=Number.MAX_SAFE_INTEGER),e>t&&([e,t]=[t,e]),Math.max(e,Math.min(i,t))}function js(i,e,t,n){if(Ft(i))return R(i,t,n);if(e=Ft(e)?e:0,i==null||typeof i!="string")return e;const r=Number.parseFloat(i);return Number.isNaN(r)?e:R(r,t,n)}function Qn(i,e){return O(i)?{isEnabled:Ot(i.isEnabled,e.isEnabled),volume:js(i.volume,e.volume,0,1)}:e}function oh(i){const e=F(E.Settings.audio);return O(i)&&(e.bgm=Qn(i.bgm,e.bgm),e.sound=Qn(i.sound,e.sound),e.voice=Qn(i.voice,e.voice)),e}function ke(i,e){return e.includes(i)}function ah(i,e){return ke(i,Eo)?i:e}function lh(i){const e=F(E.Settings.device);return O(i)&&(e.inputDevice=ah(i.inputDevice,e.inputDevice)),e}function uh(i){const e=F(E.Settings.storybook);return O(i)&&(e.aacSymbolsEnabled=Ot(i.aacSymbolsEnabled,e.aacSymbolsEnabled),e.captionHiliteColorIndex=js(i.captionHiliteColorIndex,e.captionHiliteColorIndex,0,w.CaptionHilites.Colors.length-1),e.captionHilitesEnabled=Ot(i.captionHilitesEnabled,e.captionHilitesEnabled),e.captionsEnabled=Ot(i.captionsEnabled,e.captionsEnabled),e.helpfulTipsEnabled=Ot(i.helpfulTipsEnabled,e.helpfulTipsEnabled)),e}function _e(i){return typeof i=="number"&&Number.isFinite(i)}function ch(i){return _e(i)&&i>=0&&Math.floor(i)===i}function hh(i){return typeof i=="string"}function dh(i){return hh(i)&&i.length>0}function ph(i){const e=i;if(!(!O(i)||!ch(e.progresFrameOrLabel)&&!dh(e.progresFrameOrLabel)))return e}function fh(i){if(!O(i))return F(E.Settings.storybooksStates);const e=i;return Object.keys(e).forEach(n=>{const r=e[n];if(r){const s=ph(r);s?e[n]=s:console.warn(`unable to parse storybook state with id: ${n}`)}else delete e[n],console.warn(`unable to parse storybook state with id: ${n}`)}),e}function gh(i){return O(i)?i:typeof i=="string"?sh(i):void 0}function yh(i){const e=gh(i),t={audio:oh(e==null?void 0:e.audio),device:lh(e==null?void 0:e.device),hasCompletedTutorial:Ot(e==null?void 0:e.hasCompletedTutorial),storybook:uh(e==null?void 0:e.storybook),storybooksStates:fh(e==null?void 0:e.storybooksStates)};return{target:t,wasSourceMirrored:rh(t,e,{strict:!0})}}const Us="settings";class Me{static Read(){let e;try{e=localStorage.getItem(Us)}catch(n){console.warn(n);return}const t=yh(e);return t.wasSourceMirrored||(Me.Write(t.target)?console.info("updated incoming settings data"):console.warn("unable to update incoming settings data")),t.target}static Write(e){try{const t=JSON.stringify(e);localStorage.setItem(Us,t)}catch(t){return console.warn(t),!1}return!0}constructor(){throw new Error("instances of this class may not be created")}}class vh{constructor(){a(this,"_data");this.readFromLocalStorage()||(this._data=F(E.Settings))}apply(e){return this._data=F(e),this}get data(){return this._data}readFromLocalStorage(){const e=Me.Read();return e!==void 0?(this._data=e,!0):!1}reset(){return this._data=F(E.Settings),this}writeToLocalStorage(){return Me.Write(this._data)}}function mh(i,e=!0){let t=i.getBounds();return e&&(!t||t.isEmpty())&&(t=i.nominalBounds??void 0),t}class H{constructor(e,t,n,r=!1){a(this,"_blueNormalized");a(this,"_greenNormalized");a(this,"_redNormalized");e===void 0?(this.redNormalized=0,this.greenNormlized=0,this.blueNormalized=0):typeof e=="string"?this.hexStringToColor(e):t===void 0||n===void 0?r?(this.redNormalized=e,this.greenNormlized=t??0,this.blueNormalized=n??0):(this.red=(e&16711680)>>16,this.green=(e&65280)>>8,this.blue=e&255):r?(this.redNormalized=e,this.greenNormlized=t,this.blueNormalized=n):(this.red=e,this.green=t,this.blue=n)}get blue(){return H.GetColorComponent(this._blueNormalized)}set blue(e){this._blueNormalized=H.SetColorComponent(e)}get blueNormalized(){return this._blueNormalized}set blueNormalized(e){this._blueNormalized=R(e,0,1)}static Create(e,t,n,r=!1){return e===void 0?new H:typeof e=="string"?new H(e):t!==void 0&&n!==void 0?new H(e,t,n,r):new H(e)}static GetColorComponent(e){return e=R(e,0,1),e===1?255:e*256}get green(){return H.GetColorComponent(this._greenNormalized)}set green(e){this._greenNormalized=H.SetColorComponent(e)}get greenNormlized(){return this._greenNormalized}set greenNormlized(e){this._greenNormalized=R(e,0,1)}hexStringToColor(e){if(!e)return-1;e=e.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,(o,l,u,c)=>l+l+u+u+c+c);const t=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!t)return-1;const[,n,r,s]=t;return this.red=n?Number.parseInt(n,16):0,this.green=r?Number.parseInt(r,16):0,this.blue=s?Number.parseInt(s,16):0,this.value}numericalToColor(e){return this.red=(e&16711680)>>16,this.green=(e&65280)>>8,this.blue=e&255,this.value}setColor(e){return typeof e=="string"?this.hexStringToColor(e):this.numericalToColor(e),this}get red(){return H.GetColorComponent(this._redNormalized)}set red(e){this._redNormalized=H.SetColorComponent(e)}get redNormalized(){return this._redNormalized}set redNormalized(e){this._redNormalized=R(e,0,1)}static SetColorComponent(e){return e=R(e,0,255),e===255?1:e/256}get value(){return this.red<<16|this.green<<8|this.blue}}function Sh(i,e){if(i.uncache(),e){const t=H.Create(e),n=0,r=0,s=0,o=1,l=t.red,u=t.green,c=t.blue,h=0,d=new createjs.ColorFilter(n,r,s,o,l,u,c,h);i.filters=[d];const p=mh(i);p?i.cache(p.x,p.y,p.width,p.height):console.warn(`bounds is unavailable on clip: ${i.name}`,i)}else i.filters=null}function bh(i,e){if(i.visible=e.captionHilitesEnabled,i.visible){const{Colors:t}=w.CaptionHilites,n=t[e.captionHiliteColorIndex]??t[E.Settings.storybook.captionHiliteColorIndex]??t[0];Sh(i,n)}}const Jn={AacSymbols:"aacSymbolsDisplay",CaptionHilites:"captionHilitesContainer",Captions:"captionsContainer"};class Ch{constructor(e){a(this,"engine");a(this,"captionHilitesLabelsByName");a(this,"currentCaptionHiliteslabel");a(this,"currentDisplayFrame");a(this,"prevDisplayFrame");this.engine=e,this.captionHilitesLabelsByName=new Map,this.currentDisplayFrame=-1,this.prevDisplayFrame=this.currentDisplayFrame,this.onStageTick=this.onStageTick.bind(this)}start(){this.display.stage.addEventListener(m.TICK,this.onStageTick)}updateFromSettings(){this.updateFromSettingsCaptions().updateFromSettingsAacSymbols().updateFromSettingsCaptionHilites()}get aacSymbolsDisplay(){return this.findUnitDisplay(Jn.AacSymbols)}get captionsDisplay(){return this.findUnitDisplay(Jn.Captions)}get captionHilitesDisplay(){return this.findUnitDisplay(Jn.CaptionHilites)}get display(){return this.engine.exportRoot.display}findUnitDisplay(e){return this.display.children.find(n=>{var r;return n instanceof createjs.MovieClip?(r=n.name)==null?void 0:r.startsWith(e):!1})}getCaptionHilitesLabelsOf(e){let t=this.captionHilitesLabelsByName.get(e.name);return t||(t=ze(e).reverse(),this.captionHilitesLabelsByName.set(e.name,t)),t}getCurrentCaptionHiliteLabel(){const{captionHilitesDisplay:e}=this;if(!e)return null;const t=this.getCaptionHilitesLabelsOf(e),{currentFrame:n}=e,r=n,s=t.find(o=>r>=o.position);return s?s.label:null}onStageTick(){this.updateCurrentFrame()&&this.updateCaptionHilites(),this.updateCaptions()}updateCaptionHilites(){const{captionHilitesDisplay:e}=this;if(!e)return;const t=this.prevDisplayFrame===-1?this.currentDisplayFrame:this.currentDisplayFrame+(this.currentDisplayFrame-this.prevDisplayFrame);e.gotoAndStop(t);const n=this.getCurrentCaptionHiliteLabel();n!==this.currentCaptionHiliteslabel&&(this.currentCaptionHiliteslabel=n,this.updateFromSettingsCaptionHilites())}updateCaptions(){const{captionsDisplay:e}=this;e&&(e.visible=this.userSettingsData.storybook.captionsEnabled)}updateCurrentFrame(){const{currentFrame:e}=this.display;return e===this.currentDisplayFrame?!1:(this.prevDisplayFrame=this.currentDisplayFrame,this.currentDisplayFrame=e,!0)}updateFromSettingsAacSymbols(){const{aacSymbolsDisplay:e}=this;return e&&(e.visible=this.userSettingsData.storybook.aacSymbolsEnabled),this}updateFromSettingsCaptionHilites(){const{captionHilitesDisplay:e}=this;return e&&bh(e,this.userSettingsData.storybook),this}updateFromSettingsCaptions(){return this.updateCaptions(),this}updateFromTickProgressBar(){const{startTimelineFrame:e}=this.engine;if(e>=0){const t=this.display.totalFrames-e+1;this.engine.progress=this.display.currentFrame/t}else this.engine.progress=0;return this}get userSettingsData(){return this.engine.userSettingsData}}const it={CLOSE:"close"};function Bh(i,e){const t=i.entries();let n=t.next();for(;!n.done;){const[r,s]=n.value;if(s===e)return r;n=t.next()}}function Ph(i,e,t){i.forEach(n=>{n!==void 0&&(n[e]=t)})}function Zn(i,e){Ph(i,"visible",e)}const z={Disabled:"disabled",Down:"down",Hit:"hit",Out:"out",Over:"over",Selected:"selected"},j={PRESSED:"pressed"};class Oe{constructor(e){a(this,"target");a(this,"eventsEmitter");this.target=e,this.eventsEmitter=new X,this.onTargetCallback=this.onTargetCallback.bind(this)}dispose(){this.removeAll()}emit(e,...t){return this.eventsEmitter.emit(e,t),this}off(e,t,n,r){return this.eventsEmitter.off(e,t,n,r),this.eventsEmitter.listenerCount(e)===0&&this.target.removeEventListener(e,this.onTargetCallback),this}on(e,t,n,r=!1){return this.eventsEmitter.listenerCount(e)===0&&this.target.addEventListener(e,this.onTargetCallback),r?this.eventsEmitter.once(e,t,n):this.eventsEmitter.on(e,t,n),this}once(e,t,n){return this.on(e,t,n,!0)}removeAll(e){const t=this.eventsEmitter.eventNames();return this.eventsEmitter.removeAllListeners(e),e?this.target.removeEventListener(e,this.onTargetCallback):t.forEach(n=>{ke(n,bi)&&this.target.removeEventListener(n,this.onTargetCallback)}),this}onTargetCallback(e){const t=e;ke(t.type,bi)&&this.eventsEmitter.emit(t.type,t,this)}}class Z extends X{constructor(t){super();a(this,"display");a(this,"cjsEventsHandler");a(this,"_dataMap");this.display=t,this.setInternalCjsObject(),this.cjsEventsHandler=new Oe(t)}get alpha(){return this.display.alpha}set alpha(t){this.setAlpha(t)}copyPosition(t){return this.setPosition(t.x,t.y)}get dataMap(){return this._dataMap||(this._dataMap=new Map),this._dataMap}static Dispose(t){t==null||t.dispose()}dispose(){this.disposeDataMap(),this.removeAllListeners(),this.cjsEventsHandler.dispose()}disposeDataMap(){return this._dataMap=void 0,this}get enabled(){return this.display.mouseEnabled}set enabled(t){this.setEnabled(t)}static Get(t){return Z._InternalCjsObjectHolder(t)._cjsData}getData(t){return this._dataMap?this._dataMap.get(t):void 0}moveToBottom(){var t;return(t=this.display.parent)==null||t.setChildIndex(this.display,0),this}moveToTop(){const{parent:t}=this.display;return t==null||t.setChildIndex(this.display,t.children.length-1),this}get name(){return this.display.name??""}set name(t){this.setName(t)}get scale(){return this.scaleX}set scale(t){this.setScale(t,t)}get scaleX(){return this.display.scaleX}set scaleX(t){this.setScaleX(t)}get scaleY(){return this.display.scaleY}set scaleY(t){this.setScaleY(t)}setAlpha(t){return this.display.alpha=t,this}setEnabled(t){return t!==this.enabled&&(this.display.mouseEnabled=t),this}setName(t){return this.display.name=t??"",this}setPosition(t,n){return this.x=t,this.y=n,this}setScale(t,n){return this.scaleX=t,this.scaleY=n??t,this}setScaleX(t){return this.display.scaleX=t,this}setScaleY(t){return this.display.scaleY=t,this}setVisible(t){return this.display.visible=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}get visible(){return this.display.visible}set visible(t){this.setVisible(t)}get x(){return this.display.x}set x(t){this.display.x=t}get y(){return this.display.y}set y(t){this.display.y=t}getInternalCjsObject(){return this.internalCjsObjectHolder._cjsData}static _InternalCjsObjectHolder(t){return t}get internalCjsObjectHolder(){return Z._InternalCjsObjectHolder(this.display)}setInternalCjsObject(){this.internalCjsObjectHolder._cjsData=this}}function Eh(i,e){const t=pt(i,e);return t instanceof createjs.BitmapText?t:void 0}function ti(i,e){i!==void 0&&e!==void 0&&(i.text=e)}function ei(i,e,t){const n=pt(i,e);if(n instanceof createjs.Text)return ti(n,t),n}function ni(i,e){return Eh(i,e)||ei(i,e)}function Vs(i){i=i instanceof createjs.MovieClip?i:i.display;const e=ze(i),t={};return e.forEach(n=>{t[n.label]=n.position}),t}const Fe=new Set;class Dh{constructor(e,t,n,r,s,o,l){a(this,"target");a(this,"downLabel");a(this,"outLabel");a(this,"overLabel");a(this,"selectedLabel");a(this,"labelsByName");a(this,"_isDown");a(this,"_isOver");a(this,"_isSelected");a(this,"_shouldUseDisabledState");a(this,"_enabled");this.onTargetRollOver=this.onTargetRollOver.bind(this),this.onTargetRollOut=this.onTargetRollOut.bind(this),this.onTargetMouseDown=this.onTargetMouseDown.bind(this),this.onTargetPressUp=this.onTargetPressUp.bind(this),this.target=e,this.labelsByName=Vs(e),this.downLabel=r||z.Down,this.overLabel=n||z.Over,this.outLabel=t||z.Out,this.selectedLabel=l||z.Selected,this._isDown=!1,this._isOver=!1,this._isSelected=!1,this._shouldUseDisabledState=!0,e instanceof createjs.Container&&(e.mouseChildren=!1),this.enabled=e.mouseEnabled,this.initHitArea(s,o)}dispose(){const{target:e}=this;Fe.delete(e),e.cursor=null,e.removeEventListener("rollover",this.onTargetRollOver),e.removeEventListener("rollout",this.onTargetRollOut),e.removeEventListener("mousedown",this.onTargetMouseDown),e.removeEventListener("pressup",this.onTargetPressUp)}get enabled(){return this._enabled}set enabled(e){this.setEnabled(e)}get isDown(){return this._isDown}get isOver(){return this._isOver}onTargetVisibilityChanged(){}setEnabled(e){if(e===this._enabled)return this;this._enabled=e;const{target:t}=this;return e?(t.cursor="pointer",t.addEventListener("rollover",this.onTargetRollOver),t.addEventListener("rollout",this.onTargetRollOut),t.addEventListener("mousedown",this.onTargetMouseDown),t.addEventListener("pressup",this.onTargetPressUp)):(t.cursor=null,t.removeEventListener("rollover",this.onTargetRollOver),t.removeEventListener("rollout",this.onTargetRollOut),t.removeEventListener("mousedown",this.onTargetMouseDown),t.removeEventListener("pressup",this.onTargetPressUp)),this.enabled?this.updateEnabled():this.updateDisabled(),this}get selected(){return this._isSelected}set selected(e){this.setSelected(e)}setSelected(e){return this.enabled?e===this._isSelected?this:(this._isSelected=e,this._isOver?this.target.gotoAndStop(this.overLabel):this._isDown?this.target.gotoAndStop(this.downLabel):this.target.gotoAndStop(this.getActingOutFrameLabel()),this):this}setShouldUseDisabledState(e){return e!==this._shouldUseDisabledState&&(this._shouldUseDisabledState=e,this.update()),this}get shouldUseDisabledState(){return this._shouldUseDisabledState}set shouldUseDisabledState(e){this.setShouldUseDisabledState(e)}update(){this.enabled?this.updateEnabled():this.updateDisabled()}getActingOutFrameLabel(){const e=this.selected?this.selectedLabel:this.outLabel,t=this.labelsByName[e];return t!==void 0?t:this.outLabel}initHitArea(e,t){e instanceof createjs.MovieClip?this.initHitAreaUsingCustomArea(e,t):this.initHitAreaUsingDefaultArea()}initHitAreaUsingCustomArea(e,t){t&&(e.actionsEnabled=!1,e.gotoAndStop(t)),this.target.hitArea=e}initHitAreaUsingDefaultArea(){const{target:e}=this,n=Vs(e)[z.Hit];if(n===void 0)return;const r=e.currentFrame;e.gotoAndStop(n);const s=e.children[0];s&&(s instanceof createjs.MovieClip&&(s.actionsEnabled=!1),e.hitArea=s),e.gotoAndStop(r)}onTargetMouseDown(){this._isDown=!0,this.target.gotoAndStop(this.downLabel)}onTargetPressUp(){this._isDown=!1,this.target.gotoAndStop(this._isOver?this.overLabel:this.getActingOutFrameLabel())}onTargetRollOver(){this._isOver=!0,Fe.add(this.target),this.target.gotoAndStop(this._isDown?this.downLabel:this.overLabel)}onTargetRollOut(){this._isOver=!1,Fe.delete(this.target),this.target.gotoAndStop(this._isDown?this.overLabel:this.getActingOutFrameLabel())}updateDisabled(){this._isOver=!1,this._isDown=!1,this.target.gotoAndStop(this.shouldUseDisabledState?z.Disabled:this.getActingOutFrameLabel())}updateEnabled(){this._isOver=Fe.has(this.target),this._isDown=!1,this.target.gotoAndStop(this._isOver?z.Over:this.getActingOutFrameLabel())}}const Gs={LabelText:"txtLabel"};class Ks extends Z{constructor(t,n){super(t);a(this,"helper");t.stop(),this.helper=this.createButtonHelper(n),this.cjsEventsHandler.on(m.CLICK,this.onDisplayClick,this)}get buttonLabel(){return ni(this.display,Gs.LabelText)}get buttonLabelText(){return this.getButtonLabelText()}set buttonLabelText(t){this.setButtonLabelText(t)}dispose(){super.dispose(),this.helper.dispose()}getButtonLabelText(){var t;return((t=this.buttonLabel)==null?void 0:t.text)??""}get isDown(){return this.helper.isDown}get isOver(){return this.helper.isOver}setEnabled(t){return super.setEnabled(t),this.helper.enabled=t,this}setButtonLabelText(t){const n=ni(this.display,Gs.LabelText);return ti(n,t),this}setSelected(t){return this.helper.setSelected(t),this}setShouldUseDisabledState(t){return this.helper.shouldUseDisabledState=t,this}setVisible(t){return super.setVisible(t),t!==this.visible&&this.helper.onTargetVisibilityChanged(),this}get shouldUseDisabledState(){return this.helper.shouldUseDisabledState}set shouldUseDisabledState(t){this.setShouldUseDisabledState(t)}createButtonHelper(t){let n;return t&&(n=t instanceof createjs.DisplayObject?t:new t),new Dh(this.display,z.Out,z.Over,z.Down,n,z.Hit)}onDisplayClick(t){this.emit(j.PRESSED,this)}}function mt(i,e,t,n,r){const s=typeof e=="string"?P(i,e):e,o=s?new Ks(s,n):void 0;return o&&t&&o.addListener(j.PRESSED,t,r),o}class Ws extends Z{constructor(t,n,r="buttonDisplay"){super(t);a(this,"_buttons");a(this,"defaultButton");typeof r=="string"&&(r=[r]),this._buttons=this.onInitButtons(t,r,n)||this.initButtons(t,r,n),this.defaultButton=this._buttons.find(s=>!!s)}get button(){return this.defaultButton}dispose(){super.dispose(),this.forEachButton(t=>{t.dispose()}),this._buttons.length=0}forEachButton(t,n){return this._buttons.forEach(r=>{r&&t.call(n,r)}),this}getButtonAt(t){return this._buttons[t]}getButtonByName(t){return this._buttons.find(n=>(n==null?void 0:n.name)===t)}get isDown(){var t;return((t=this.defaultButton)==null?void 0:t.isDown)===!0}get isOver(){var t;return((t=this.defaultButton)==null?void 0:t.isOver)===!0}setEnabled(t){return super.setEnabled(t),this.forEachButton(n=>{n.enabled=t}),this}setShouldUseDisabledState(t){return this.forEachButton(n=>{n.setShouldUseDisabledState(t)}),this}get shouldUseDisabledState(){var t;return((t=this.defaultButton)==null?void 0:t.shouldUseDisabledState)===!0}set shouldUseDisabledState(t){this.setShouldUseDisabledState(t)}onButtonCallback(){this.emit(j.PRESSED,this)}onInitButtons(t,n,r){}initButtons(t,n,r){const s=[];return n.forEach(o=>{const l=mt(t,o,this.onButtonCallback,r,this);s.push(l)}),s}}function Re(i,e){const t=pt(i,e);return t instanceof createjs.Container?t:void 0}const zs={OffButton:"off_display",OnButton:"on_display"};class wh extends Ws{constructor(t,n=!1,r=void 0,s=zs.OnButton,o=zs.OffButton){super(t,r,[s,o]);a(this,"_offButton");a(this,"_onButton");a(this,"_isOn");this._onButton=this.getButtonByName(s),this._offButton=this.getButtonByName(o),this.isOn=n}dispose(){var t,n;super.dispose(),(t=this._offButton)==null||t.dispose(),this._offButton=void 0,(n=this._onButton)==null||n.dispose(),this._onButton=void 0}get isDown(){var t;return((t=this.activeButton)==null?void 0:t.isDown)??!1}get isOn(){return this._isOn}set isOn(t){this.setOn(t)}get isOver(){var t;return((t=this.activeButton)==null?void 0:t.isOver)??!1}get offButton(){return this._offButton}get onButton(){return this._onButton}setOn(t){var n,r;return t===this._isOn?this:((n=this.activeButton)==null||n.setVisible(!1),this._isOn=t,(r=this.activeButton)==null||r.setVisible(!0),this)}onInitButtons(t,n,r){const[s,o]=n;let l,u;return s&&(l=this.initStateButton(s,r)),o&&(u=this.initStateButton(o,r)),[l,u]}get activeButton(){return this.isOn?this._onButton:this._offButton}initStateButton(t,n){const r=mt(this.display,t,this.onButtonPressed,n,this);return r||console.warn(`no state button display found with name: ${t}`),r==null?void 0:r.setVisible(!1)}onButtonPressed(){this.isOn=!this._isOn,this.emit(j.PRESSED,this)}}function qs(i,e,t,n,r,s){const o=P(i,e);if(!o)return;const l=new wh(o,t,s);return n&&l.addListener(j.PRESSED,n,r),l}const Th={CloseButton:"closeButtonDisplay"};class Rt extends X{constructor(t,n){super();a(this,"engine");a(this,"container");a(this,"closeButton");this.container=t,this.container.stop(),this.engine=n,this.onInit()}dispose(){this.removeAllListeners(),this.closeButton=Ks.Dispose(this.closeButton)}initButton(t,n,r,s,o){s=s??this.container,o=o===void 0?this:o;const l=mt(s,t,n,r,o);return l==null||l.on(j.PRESSED,this.onButtonPressed,this),l}initCheckbox(t,n,r,s,o,l){s=s??this.container,o=o===void 0?this:o;const u=qs(s,t,r,n,o,l);return u==null||u.on(j.PRESSED,this.onCheckboxPressed,this),u}initCompoundButton(t,n,r,s,o){r=r??this.container,o=o===void 0?this:o;const l=Re(r,t);if(!l)return;const u=new Ws(l,s);return u.on(j.PRESSED,this.onButtonPressed,this),u.on(j.PRESSED,n,o),u}setVisible(t){return this.visible=t,this}get visible(){return this.container.visible}set visible(t){this.container.visible=t}clearText(t){return this.setText(t,"")}initCloseButton(t){return this.initButton(Th.CloseButton,this.onClosePressed,t)}initDisplayObject(t,n){return n=n??this.container,pt(n,t)}initMovieClip(t,n){return this.initDisplayObject(t,n)}initText(t,n){return n=n??this.container,ni(n,t)}onClosePressed(){this.emit(it.CLOSE,this)}onInit(t){this.closeButton=this.initCloseButton(t)}setText(t,n){return t&&(t.text=typeof n=="number"?n.toString(10):n),this}onButtonPressed(){this.engine.playSound(this.engine.lib.audioIds.RadioHeavyButtonPress)}onCheckboxPressed(){this.engine.playSound(this.engine.lib.audioIds.RadioLightButtonPress)}}const ii={Abort:"abort",AnimationCancel:"animationcancel",AnimationEnd:"animationend",AnimationIteration:"animationiteration",AnimationStart:"animationstart",AuxClick:"auxclick",BeforeInput:"beforeinput",Blur:"blur",Cancel:"cancel",CanPlay:"canplay",CanPlayThrough:"canplaythrough",Change:"change",Click:"click",Close:"close",CompositionEnd:"compositionend",CompositionStart:"compositionstart",CompositionUpdate:"compositionupdate",ContextMenu:"contextmenu",Copy:"copy",CueChange:"cuechange",Cut:"cut",DoubleClick:"dblclick",Drag:"drag",DragEnd:"dragend",DragEnter:"dragenter",DragLeave:"dragleave",DragOver:"dragover",DragStart:"dragstart",Drop:"drop",DurationChange:"durationchange",Emptied:"emptied",Ended:"ended",Error:"error",Focus:"focus",FocusIn:"focusin",FocusOut:"focusout",FormData:"formdata",GotPointercapture:"gotpointercapture",Input:"input",Invalid:"invalid",KeyDown:"keydown",KeyPress:"keypress",KeyUp:"keyup",Load:"load",LoadedData:"loadeddata",LoadedMetadata:"loadedmetadata",LoadStart:"loadstart",LostPointerCapture:"lostpointercapture",MouseDown:"mousedown",MouseEnter:"mouseenter",MouseLeave:"mouseleave",MouseMove:"mousemove",MouseOut:"mouseout",MouseOver:"mouseover",MouseUp:"mouseup",Paste:"paste",Pause:"pause",Play:"play",Playing:"playing",PointerDancel:"pointercancel",PointerDown:"pointerdown",PointerEnter:"pointerenter",PointerLeave:"pointerleave",PointerMove:"pointermove",PointerOut:"pointerout",PointerOver:"pointerover",PointerUp:"pointerup",Progress:"progress",RateChange:"ratechange",Reset:"reset",Resize:"resize",Scroll:"scroll",ScrollEnd:"scrollend",SecurityPolicyViolation:"securitypolicyviolation",Seeked:"seeked",Seeking:"seeking",Select:"select",SelectionChange:"selectionchange",SelectStart:"selectstart",SlotChange:"slotchange",Stalled:"stalled",Submit:"submit",Suspend:"suspend",TimeUpdate:"timeupdate",Toggle:"toggle",TouchCancel:"touchcancel",TouchEnd:"touchend",TouchMove:"touchmove",TouchStart:"touchstart",TransitionCancel:"transitioncancel",TransitionEnd:"transitionend",TransitionRun:"transitionrun",TransitionStart:"transitionstart",VolumeChange:"volumechange",Waiting:"waiting",WebkitAnimationEnd:"webkitanimationend",WebkitAnimationIteration:"webkitanimationiteration",WebkitAnimationStart:"webkitanimationstart",WebkitTransitionEnd:"webkittransitionend",Wheel:"wheel"},Xs={AltLeft:"AltLeft",AltRight:"AltRight",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",Backquote:"Backquote",Backslash:"Backslash",Backspace:"Backspace",BracketLeft:"BracketLeft",BracketRight:"BracketRight",CapsLock:"CapsLock",Comma:"Comma",ContextMenu:"ContextMenu",ControlLeft:"ControlLeft",ControlRight:"ControlRight",Delete:"Delete",Digit0:"Digit0",Digit1:"Digit1",Digit2:"Digit2",Digit3:"Digit3",Digit4:"Digit4",Digit5:"Digit5",Digit6:"Digit6",Digit7:"Digit7",Digit8:"Digit8",Digit9:"Digit9",End:"End",Equal:"Equal",Enter:"Enter",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12",Home:"Home",Insert:"Insert",KeyA:"KeyA",KeyB:"KeyB",KeyC:"KeyC",KeyD:"KeyD",KeyE:"KeyE",KeyF:"KeyF",KeyG:"KeyG",KeyH:"KeyH",KeyI:"KeyI",KeyJ:"KeyJ",KeyK:"KeyK",KeyL:"KeyL",KeyM:"KeyM",KeyN:"KeyN",KeyO:"KeyO",KeyP:"KeyP",KeyQ:"KeyQ",KeyR:"KeyR",KeyS:"KeyS",KeyT:"KeyT",KeyU:"KeyU",KeyV:"KeyV",KeyW:"KeyW",KeyX:"KeyX",KeyY:"KeyY",KeyZ:"KeyZ",MetaLeft:"MetaLeft",MetaRight:"MetaRight",Minus:"Minus",Numpad0:"Numpad0",Numpad1:"Numpad1",Numpad2:"Numpad2",Numpad3:"Numpad3",Numpad4:"Numpad4",Numpad5:"Numpad5",Numpad6:"Numpad6",Numpad7:"Numpad7",Numpad8:"Numpad8",Numpad9:"Numpad9",NumpadAdd:"NumpadAdd",NumpadBackspace:"NumpadBackspace",NumpadClear:"NumpadClear",NumpadComma:"NumpadComma",NumpadDecimal:"NumpadDecimal",NumpadDivide:"NumpadDivide",NumpadEnter:"NumpadEnter",NumpadEqual:"NumpadEqual",NumpadMultiply:"NumpadMultiply",NumpadSubtract:"NumpadSubtract",PageDown:"PageDown",PageUp:"PageUp",Period:"Period",Quote:"Quote",Semicolon:"Semicolon",ShiftLeft:"ShiftLeft",ShiftRight:"ShiftRight",Slash:"Slash",Space:"Space",Tab:"Tab"},St={NEXT:"next",SELECT:"select"};function xh(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function Ne(i,e,t){if(!i)return t;const n=typeof i;if(n==="number"||n==="string"||n==="boolean")return t;const r=i;return xh(r,e)&&r[e]!==void 0?r[e]:t}function tt(i,e,t=0){const n=Ne(i,e,t);return _e(n)?n:t}class dt{constructor(e){a(this,"callback");a(this,"context");a(this,"delayMs");a(this,"repeatCount");a(this,"currentRepeatCount");a(this,"isRunning");a(this,"timerId");a(this,"params");const t=e??{};this.delayMs=Math.floor(Math.max(0,tt(t,"delayMs",1e3))),this.repeatCount=Math.floor(tt(t,"repeat",0)),this.callback=t.callback,this.context=t.context,this.params=t.params,this.onInterval=this.onInterval.bind(this),this.currentRepeatCount=0,this.timerId=null,this.isRunning=!1}static Create(e){const t=new dt(e);return t.start(),t}static Dispose(e){e&&e.stop()}start(){this.isRunning||(this.currentRepeatCount=0,this.timerId=setInterval(this.onInterval,this.delayMs),this.isRunning=!0)}stop(){this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.isRunning=!1}onInterval(){if(this.callback&&this.callback.call(this.context,this.params,this),this.repeatCount===0)this.stop();else if(this.repeatCount>0){const e=this.currentRepeatCount+1;e>this.repeatCount?this.stop():this.currentRepeatCount=e}}}class Ys extends X{constructor(t){super();a(this,"engine");a(this,"singleSwitchTimer");a(this,"_isEnabled");this.engine=t,this.onDocumentKeyUp=this.onDocumentKeyUp.bind(this),this._isEnabled=!1,this.updateFromSettings()}dispose(){this.isEnabled=!1,this.removeAllListeners()}isDualSwitchEnabled(){return this.engine.userSettingsData.device.inputDevice===Y.DualSwitch}get isEnabled(){return this._isEnabled}set isEnabled(t){this.setEnabled(t)}isSingleSwitchEnabled(){return this.engine.userSettingsData.device.inputDevice===Y.SingleSwitch}setEnabled(t){return t===this._isEnabled?this:(this._isEnabled=t,this._isEnabled?document.addEventListener(ii.KeyUp,this.onDocumentKeyUp):document.removeEventListener(ii.KeyUp,this.onDocumentKeyUp),this.handleSingleSwitch(),this)}updateFromSettings(){const t=this.isSingleSwitchEnabled()||this.isDualSwitchEnabled();return this.isEnabled!==t?this.setEnabled(t):this.handleSingleSwitch(),this.isEnabled}handleSingleSwitch(){return this.isEnabled&&this.isSingleSwitchEnabled()?(this.handleSingleSwitchEnable(),!0):(this.handleSingleSwitchDisable(),!1)}handleSingleSwitchDisable(){var t;(t=this.singleSwitchTimer)==null||t.stop(),this.singleSwitchTimer=void 0}handleSingleSwitchEnable(){this.singleSwitchTimer||(this.singleSwitchTimer=dt.Create({callback:()=>{this.emit(St.NEXT,this)},delayMs:E.EngineConfig.singleDeviceDelayMs,repeat:-1}))}onDocumentKeyUp(t){t.code===Xs.Space?this.emit(St.NEXT,this):t.code===Xs.Enter&&this.emit(St.SELECT,this)}}const Nt={DRAG:"drag",START:"start",STOP:"stop"};class Qs extends X{constructor(t,n){super();a(this,"displayTarget");a(this,"dragBounds");a(this,"cjsEventsHandler");a(this,"inputTarget");a(this,"dragOffset");this.displayTarget=t,this.inputTarget=n??this.displayTarget,this.cjsEventsHandler=new Oe(this.inputTarget).on(m.MOUSE_DOWN,this.onDisplayMouseDown,this).on(m.PRESS_MOVE,this.onDisplayPressMove,this).on(m.PRESS_UP,this.onDisplayPressUp,this),this.dragOffset={x:0,y:0},this.dragBounds=null}clearDragBounds(){return this.dragBounds=null,this}dispose(){this.removeAllListeners(),this.cjsEventsHandler.dispose()}setDragBounds(t){return this.dragBounds?this.dragBounds.copy(t):this.dragBounds=t.clone(),this}onDisplayMouseDown(t){this.dragOffset.x=t.localX,this.dragOffset.y=t.localY,this.emit(Nt.START,t,this)}onDisplayPressMove(t){let n=this.displayTarget.x+t.localX-this.dragOffset.x,r=this.displayTarget.y+t.localY-this.dragOffset.y;this.dragBounds&&(n=R(n,this.dragBounds.x,this.dragBounds.x+this.dragBounds.width),r=R(r,this.dragBounds.y,this.dragBounds.y+this.dragBounds.height)),this.displayTarget.x=n,this.displayTarget.y=r,this.emit(Nt.DRAG,t,this)}onDisplayPressUp(t){this.dragOffset.x=0,this.dragOffset.y=0,this.emit(Nt.STOP,t,this)}}const rt={CHANGED:"changed",DRAG_STARTED:"dragStarted",DRAG_STOPPED:"dragStopped"},$e={Back:"back",BackHitArea:"back_hit_area",Fill:"fill",Handle:"handle"};class Js extends Z{constructor(t,n,r){super(t);a(this,"dragManager");a(this,"handle");a(this,"back");a(this,"fill");a(this,"fillMask");a(this,"fillBounds");a(this,"handleBounds");a(this,"backBounds");a(this,"_shouldUseHandleBoundsForConstraint");a(this,"_value");this._shouldUseHandleBoundsForConstraint=!0,this.handle=this.initHandle(r),this.fill=this.initFill(),this.back=this.initBack(),this.dragManager=this.initDragManager(),this.resolveSetValue(n??0,!0,!1)}dispose(){var t,n,r;super.dispose(),(t=this.dragManager)==null||t.dispose(),(n=this.back)==null||n.dispose(),(r=this.handle)==null||r.dispose()}setEnabled(t){var n;return super.setEnabled(t),(n=this.handle)==null||n.setEnabled(t),this}setShouldUseHandleBoundsForConstraint(t){return t!==this._shouldUseHandleBoundsForConstraint?this:(this._shouldUseHandleBoundsForConstraint=t,this.updateDragBounds().updateHandle())}setValue(t,n=!0){return this.resolveSetValue(t,!0,n),this}get shouldUseHandleBoundsForConstraint(){return this._shouldUseHandleBoundsForConstraint}set shouldUseHandleBoundsForConstraint(t){this.setShouldUseHandleBoundsForConstraint(t)}get value(){return this._value}set value(t){this.setValue(t)}calcDragBounds(){if(!this.handleBounds||!this.backBounds)return;const t=this.shouldUseHandleBoundsForConstraint?this.handleBounds.width:0,n=t/2,{backBounds:r}=this,s=r.y+r.height/2;return new createjs.Rectangle(r.x+n,s,r.x+r.width-t,0)}handleBackMove(t){var l;if(!this.back||!((l=this.dragManager)!=null&&l.dragBounds))return;const n=this.dragManager.dragBounds.x,s=this.dragManager.dragBounds.x+this.dragManager.dragBounds.width-n,o=(t.localX-n)/s;this.resolveSetValue(o,!0,!0)}initBack(){const t=P(this.display,$e.Back);if(!t)return;let n=P(this.display,$e.BackHitArea);n?t.hitArea=n:n=t,this.backBounds=n.getBounds().clone(),this.backBounds.width*=n.scaleX,this.backBounds.height*=n.scaleY;const r=new Oe(t);return r.on(m.MOUSE_DOWN,this.onBackMouseDown,this),r}initDragManager(){if(!this.handle)return;const t=this.calcDragBounds();return t?new Qs(this.handle.display).on(Nt.DRAG,this.onDragManagerDrag,this).on(Nt.START,this.onDragManagerStart,this).on(Nt.STOP,this.onDragManagerStop,this).setDragBounds(t):void 0}initFill(){const t=P(this.display,$e.Fill);return t&&(this.fillMask=new createjs.Shape,t.mask=this.fillMask,this.fillBounds=t.getBounds().clone()),t}initHandle(t){const n=mt(this.display,$e.Handle,void 0,t);return n&&(this.handleBounds=n.display.getBounds().clone()),n}onBackMouseDown(t){var n;this.emit(rt.DRAG_STARTED,this),this.handleBackMove(t),(n=this.back)==null||n.on(m.PRESS_MOVE,this.onBackPressMove,this).on(m.PRESS_UP,this.onBackPressUp,this)}onBackPressMove(t){this.handleBackMove(t)}onBackPressUp(){var t;this.emit(rt.DRAG_STOPPED,this),(t=this.back)==null||t.off(m.PRESS_MOVE,this.onBackPressMove,this).off(m.PRESS_UP,this.onBackPressUp,this)}onDragManagerDrag(){var o;if(!this.handle||!((o=this.dragManager)!=null&&o.dragBounds))return;const t=this.dragManager.dragBounds.x,r=this.dragManager.dragBounds.x+this.dragManager.dragBounds.width-t,s=(this.handle.x-t)/r;this.resolveSetValue(s,!1,!0)}onDragManagerStart(){this.emit(rt.DRAG_STARTED,this)}onDragManagerStop(){this.emit(rt.DRAG_STOPPED,this)}resolveSetValue(t,n,r){t=R(t,0,1),t!==this._value&&(this._value=t,this.updateFill(),n&&this.updateHandle(),r&&this.emit(rt.CHANGED,this))}updateDragBounds(){var n;const t=this.calcDragBounds();return t&&((n=this.dragManager)==null||n.setDragBounds(t)),this}updateFill(){if(this.fillMask&&this.fill&&this.fillBounds){const t=this.fillBounds;this.fillMask.graphics.clear().drawRect(0,0,t.width*this.value,t.height)}return this}updateHandle(){var l;if(!this.handle||!((l=this.dragManager)!=null&&l.dragBounds))return this;const t=this.dragManager.dragBounds.x,r=t+this.dragManager.dragBounds.width-t;this.handle.x=t+r*this.value;const s=this.dragManager.dragBounds.y,o=t+this.dragManager.dragBounds.height;return this.handle.y=R(this.handle.y,s,o),this}}class Ah extends Js{constructor(t,n=0){super(t,n);a(this,"flag");this.flag=P(this.display,"flag"),this.shouldUseHandleBoundsForConstraint=!1}}function Ih(i,e){const t=i instanceof createjs.MovieClip?i.timeline:i,n=typeof e=="string"?t.resolve(e):e;return n??(console.warn("unable to resolve in scene timeline, frame label of value:",e),null)}const st={Bgm:"bgm",Sound:"sound",Voice:"voice"},Zs=Object.values(st);function kh(i,e){if(e instanceof createjs.MovieClip)return e;if(!e)return new createjs.MovieClip;const t=i.lib.animateClasses,n=t?t[e]:void 0;return n?new n:new createjs.MovieClip}class ri extends Z{constructor(t,n,r=!1){super(kh(t,n));a(this,"engine");a(this,"frameCallbacks");a(this,"isContainerForDisplay");a(this,"lastVisitedFrame");a(this,"syncedSoundData");a(this,"playToTween");this.engine=t,this.isContainerForDisplay=r,this.movieClip.scene=this,this.movieClip.engine=t,this.movieClip.loop=!1,this.frameCallbacks=[],this.stop(),this.lastVisitedFrame=-1,this.onDisplayTimelineChange=this.onDisplayTimelineChange.bind(this),this.onSyncedSoundComplete=this.onSyncedSoundComplete.bind(this),this.onSyncedSoundTick=this.onSyncedSoundTick.bind(this),this.timeline.addEventListener(m.CHANGE,this.onDisplayTimelineChange)}dispose(){var t;this.removeAllFrameCallbacks(),this.stop(),delete this.movieClip.scene,(t=this.display.parent)==null||t.removeChild(this.display),this.timeline.removeEventListener(m.CHANGE,this.onDisplayTimelineChange),super.dispose()}addFrameCallback(t,n,r,s=!1,o=void 0){const l=this.resolveFrame(t);if(l===null)return console.warn("unable to resolve in scene timeline, frame label of value:",t),this;const u={callback:n,context:r,frame:l,isOnce:s,params:o};return this.frameCallbacks[l]=u,this}get currentFrame(){return this.movieClip.currentFrame}set currentFrame(t){this.stopInner(t)}getChild(t){return typeof t=="number"?this.getChildAt(t):this.getChildByName(t)}getChildAt(t){return this.display.getChildAt(t)??void 0}getChildByName(t){return this.display.getChildByName(t)??void 0}getChildMovieClip(t){const n=this.getChild(t);return n instanceof createjs.MovieClip?n:void 0}isFrameValid(t){return this.resolveFrame(t)!==null}get movieClip(){const{display:t}=this;return this.isContainerForDisplay?t.getChildAt(0):t}nextFrame(){return this.movieClip.gotoAndStop(this.movieClip.currentFrame+1),this}play(t){if(t!==void 0){const n=this.resolveFrame(t);n!==null&&n!==this.movieClip.currentFrame?this.movieClip.gotoAndPlay(n):this.movieClip.play()}else this.movieClip.play();return this}playOnce(t,n,r,s){return this.addFrameCallback(this.movieClip.totalFrames-1,()=>{this.stop(),t.call(n,this,s)},n,!0,s),this.play(r)}playSound(t,n=1,r=!1,s=void 0,o=void 0){return this.engine.playSound(t,n,r,s,o)}playSyncVoice(t,n,r){return new Promise(s=>{const o=this.resolveFrame(n);if(o===null){s();return}const l=this.resolveFrame(r);if(l===null){s();return}const u=this.engine.playSound(t,this.engine.resolveSettingsVolume(st.Voice));if(!u){s();return}this.syncedSoundData&&(this.syncedSoundData.sound.stop(),this.syncedSoundData.sound.destroy()),this.syncedSoundData={endFrame:l,resolve:s,sound:u,startFrame:o},this.stop(this.syncedSoundData.startFrame),u.addEventListener(m.COMPLETE,this.onSyncedSoundComplete),createjs.Ticker.addEventListener(m.TICK,this.onSyncedSoundTick)})}playTo(t,n,r,s,o){const l=this.resolveFrame(t);if(l===null)return this;if(n!==void 0){if(this.resolveFrame(n)===null)return this;this.stop(n)}return this.playToTween&&this.stopPlayToTween(),this.playToTween=createjs.Tween.get(this,{onComplete:()=>{r==null||r.call(s,this,o)},useTicks:!0}).to({currentFrame:l},Math.abs(l-this.currentFrame)),this}playToEnd(t,n,r,s){return this.playTo(t,void 0,n,r,s)}playVoices(t,n){return this.engine.playVoice(t,n)}removeAllFrameCallbacks(){return this.frameCallbacks.length=0,this}removeFrameCallback(t){const n=this.resolveFrame(t);return n!==null&&delete this.frameCallbacks[n],this}resolveFrame(t){return Ih(this.display,t)}get stage(){return this.display.stage}stop(t){return this.stopPlayToTween(),this.stopInner(t),this}get timeline(){return this.movieClip.timeline}get totalFrames(){return this.movieClip.totalFrames}onDisplayTimelineChange(){const t=Math.round(this.timeline.position);if(this.lastVisitedFrame===t)return;if(t>=this.movieClip.totalFrames){this.movieClip.loop||this.stop(this.movieClip.totalFrames-1);return}this.lastVisitedFrame=t;const n=this.frameCallbacks[t];n&&(n.isOnce&&n.frame!==void 0&&this.removeFrameCallback(n.frame),n.callback&&n.callback.call(n.context,this,n.params))}onSyncedSoundComplete(){createjs.Ticker.removeEventListener(m.TICK,this.onSyncedSoundTick);const{syncedSoundData:t}=this;t&&(this.syncedSoundData=void 0,this.currentFrame!==t.endFrame&&this.stop(t.endFrame),t.sound.destroy(),t.resolve())}onSyncedSoundTick(){if(!this.syncedSoundData||this.syncedSoundData.sound.duration<=0){createjs.Ticker.removeEventListener(m.TICK,this.onSyncedSoundTick);return}const t=this.syncedSoundData.endFrame-this.syncedSoundData.startFrame,n=R(this.syncedSoundData.sound.position/this.syncedSoundData.sound.duration,0,1),r=Math.floor(this.syncedSoundData.startFrame+t*n);this.stop(r)}stopInner(t){if(t!==void 0){const n=this.resolveFrame(t);n!==null&&n!==this.movieClip.currentFrame?this.movieClip.gotoAndStop(n):this.movieClip.stop()}else this.movieClip.stop()}stopPlayToTween(){this.playToTween&&(createjs.Tween.removeTweens(this),this.playToTween=void 0)}}const to={COMPLETE:"complete"},_h={NextButton:"nextButtonDisplay"};class Mh extends Rt{constructor(t,n){super(n,t.engine);a(this,"scene");a(this,"nextButton");a(this,"introDelayTimer");this.scene=new ri(this.engine,n),this.nextButton=this.initButton(_h.NextButton,this.onNextButtonPressed,this.engine.lib.animateClasses.TutorialSkipNavButtonHitDisplay)}dispose(){var t;(t=this.nextButton)==null||t.dispose(),this.disposeIntroDelayTimer(),super.dispose()}present(){this.visible=!0,this.scene.stop(0),this.introDelayTimer=dt.Create({delayMs:w.TutorialIntroDelayMs,callback:()=>{this.setNextPage()}})}unpresent(){this.visible=!1}onInit(){super.onInit(this.engine.lib.animateClasses.TutorialSkipNavButtonHitDisplay)}disposeIntroDelayTimer(){this.introDelayTimer=dt.Dispose(this.introDelayTimer)}onNextButtonPressed(){this.setNextPage()}setNextPage(){this.disposeIntroDelayTimer(),this.scene.currentFrame+1<this.scene.totalFrames?this.scene.nextFrame():this.emit(to.COMPLETE,this)}}const ot={HelpfulTipsPanel:"helpfulTipsDisplay",NextButton:"nextButtonDisplay",PrevButton:"prevButtonDisplay",ProgressBar:"progressBarDisplay",RestartButton:"restartButtonDisplay",SettingsButton:"settingsButtonDisplay",TutorialPanels:"tutorialPanelsDisplay"},k={NEXT:"next",PREV:"prev",RESTART:"restart",SETTINGS:"settings",TUTORIAL_COMPLETE:"tutorialComplete"},eo={OPENED:"opened"},si={Bubble:"bubble_display",Button:"buttonDisplay",TextMessage:"txtMessage"};class Oh extends Z{constructor(t){super(t);a(this,"button");a(this,"bubble");a(this,"txtMessage");this.button=mt(this.display,si.Button,this.onButtonPressed,void 0,this),this.bubble=P(this.display,si.Bubble),this.txtMessage=ei(this.display,si.TextMessage,"")}dispose(){var t;super.dispose(),(t=this.button)==null||t.dispose()}present(t=""){return this.visible=!0,Zn([this.bubble,this.txtMessage],t.length>0),ti(this.txtMessage,t),this}unpresent(){return this.visible=!1,this}onButtonPressed(){this.emit(eo.OPENED,this)}}const no=[I.Next,I.Prev,I.Restart];class Fh extends Rt{constructor(t,n){super(t,n);a(this,"progressBar");a(this,"navButtonsByDirection");a(this,"helpfulTipsPanel");a(this,"navButtonsInOrder");a(this,"inputDeviceHandler");a(this,"settingsButton");a(this,"selectedButtonIndex");a(this,"isNavUiActive");a(this,"navStartFrame");a(this,"ticks");a(this,"tutorialManager");a(this,"navConfig");a(this,"buttonEvent");this.progressBar=this.initProgressBar(),this.navButtonsByDirection=this.initNavButtons(n.lib.animateClasses),this.navButtonsInOrder=no.map(r=>this.navButtonsByDirection.get(r)).filter(r=>!!r),this.inputDeviceHandler=this.initInputDeviceHandler(),this.selectedButtonIndex=-1,this.settingsButton=this.initButton(ot.SettingsButton,this.onSettingsPressed,n.lib.animateClasses.SettingsButtonDisplay),this.helpfulTipsPanel=this.initHelpfulTipsPanel(),this.isNavUiActive=!1,this.navStartFrame=-1,this.ticks=-1,this.onTickPessKludge=this.onTickPessKludge.bind(this),this.onExportRootTimelineChangeNav=this.onExportRootTimelineChangeNav.bind(this)}dispose(){var t,n,r;super.dispose(),this.uninitExportRootTimeline(),this.inputDeviceHandler.dispose(),(t=this.progressBar)==null||t.dispose(),(n=this.helpfulTipsPanel)==null||n.dispose(),(r=this.settingsButton)==null||r.dispose(),this.navButtonsByDirection.forEach(s=>{s==null||s.dispose()})}presentNavUi(t){var n;return this.isNavUiActive?this:(this.navStartFrame=this.engine.exportRoot.currentFrame,this.isNavUiActive=!0,Zn(this.navButtonsInOrder,!0),this.navConfig=t,(n=t==null?void 0:t.navButtonsToHide)==null||n.forEach(r=>{var s;(s=this.navButtonsByDirection.get(r))==null||s.setVisible(!1)}),this.unselectCurrentNavButton(),this.setDefaultSelectedButton((t==null?void 0:t.defaultSelectedNavButtonId)??null),this)}presentTutorial(){var t,n,r;if(!this.tutorialManager){const s=P(this.container,ot.TutorialPanels);if(!s)return console.warn("No tutorial panels display object on main panel was found with name:",ot.TutorialPanels),!1;this.tutorialManager=new Mh(this,s).once(it.CLOSE,this.onTutorialManagerClose,this).once(to.COMPLETE,this.onTutorialManagerComplete,this)}return this.tutorialManager.present(),this.unpresentNavUi(),this.visible=!0,(t=this.helpfulTipsPanel)==null||t.setVisible(!1),(n=this.settingsButton)==null||n.setVisible(!1),(r=this.progressBar)==null||r.setVisible(!1),!0}set settingsButtonVisible(t){var n;(n=this.settingsButton)==null||n.setVisible(t)}setVisible(t){const n=t!==this.visible,r=super.setVisible(t);return n&&this.update(),r}unpresentNavUi(){return this.inputDeviceHandler.isEnabled=!1,this.isNavUiActive&&(this.isNavUiActive=!1,Zn(this.navButtonsInOrder,!1)),this}unpresentTutorial(){var t,n;return(t=this.tutorialManager)==null||t.unpresent(),(n=this.settingsButton)==null||n.setVisible(!0),this}updateFromSettings(){var t;this.visible=!0,this.inputDeviceHandler.updateFromSettings(),this.setDefaultSelectedButton(((t=this.navConfig)==null?void 0:t.defaultSelectedNavButtonId)??null)}confirmSelectedNavButton(){const t=this.selectedNavButtonEvent;t&&this.emit(t,this)}initHelpfulTipsPanel(){const t=P(this.container,ot.HelpfulTipsPanel);if(!t){console.warn("No helpful tips display object on main panel was found with name:",ot.HelpfulTipsPanel);return}return new Oh(t).setVisible(!1).on(eo.OPENED,this.onHelpfulTipsOpened,this)}initInputDeviceHandler(){return new Ys(this.engine).on(St.NEXT,this.onInputDeviceNext,this).on(St.SELECT,this.onInputDeviceSelect,this)}initNavButton(t,n,r){var o;const s=(o=this.initButton(t,n,r))==null?void 0:o.setVisible(!1);return s||console.warn("No nav button on main panel was found with name:",t),s}initNavButtons(t){const n=[[I.Next,this.initNavButton(ot.NextButton,this.onNextPressed,t.NextButtonDisplay)],[I.Prev,this.initNavButton(ot.PrevButton,this.onPrevPressed,t.PrevtButtonDisplay)],[I.Restart,this.initNavButton(ot.RestartButton,this.onRestartPressed,t.RestartButtonDisplay)]],r=new Map;return n.forEach(s=>{const[o,l]=s;l&&r.set(o,l)}),r}initProgressBar(){const t=P(this.container,ot.ProgressBar);return t?new Ah(t):void 0}onExportRootTimelineChangeNav(){const{currentFrame:t}=this.engine.exportRoot;if(this.navStartFrame>-1&&t!==this.navStartFrame){console.log(`nav adjusted timeline from ${t} to ${this.navStartFrame}`);const n=this.navStartFrame;this.navStartFrame=-1,this.engine.exportRoot.stop(n)}}onHelpfulTipsOpened(){}onInputDeviceNext(){this.selectNextNavButton()}onInputDeviceSelect(){this.confirmSelectedNavButton()}onNextPressed(){this.emit(k.NEXT,this)}onPrevPressed(){this.emit(k.PREV,this)}onRestartPressed(){this.emit(k.RESTART,this)}onSettingsPressed(){this.emit(k.SETTINGS,this)}onTickPessKludge(){this.ticks+=1,!(this.ticks<4)&&(createjs.Ticker.removeEventListener(m.TICK,this.onTickPessKludge),this.buttonEvent&&(this.emit(this.buttonEvent,this),this.buttonEvent=void 0))}onTutorialManagerClose(){this.emit(k.TUTORIAL_COMPLETE,!1,this)}onTutorialManagerComplete(){this.emit(k.TUTORIAL_COMPLETE,!0,this)}get selectedNavButton(){return this.navButtonsInOrder[this.selectedButtonIndex]}get selectedNavButtonEvent(){switch(Bh(this.navButtonsByDirection,this.selectedNavButton)){case I.Prev:return k.PREV;case I.Next:return k.NEXT;case I.Restart:return k.RESTART;default:return}}selectNextNavButton(){this.selectNavButtonAt((this.selectedButtonIndex+1)%this.navButtonsInOrder.length)}selectNavButtonAt(t){var n,r;(n=this.navButtonsInOrder[this.selectedButtonIndex])==null||n.setSelected(!1),this.selectedButtonIndex=t,(r=this.navButtonsInOrder[this.selectedButtonIndex])==null||r.setSelected(!0)}setDefaultSelectedButton(t){this.inputDeviceHandler.updateFromSettings()&&t&&(this.inputDeviceHandler.isSingleSwitchEnabled()||this.inputDeviceHandler.isDualSwitchEnabled)?this.setSelectedNavButton(t):this.unselectCurrentNavButton()}setSelectedNavButton(t){const n=no.indexOf(t);this.selectNavButtonAt(n)}uninitExportRootTimeline(){this.navStartFrame=-1,this.engine.exportRoot.timeline.removeEventListener(m.CHANGE,this.onExportRootTimelineChangeNav)}unselectCurrentNavButton(){this.selectNavButtonAt(-1)}update(){this.tutorialManager||this.updateHelpfupTipsPanel()}updateHelpfupTipsPanel(){}}const oi={CLOSE:"close",COMPLETE:"complete"},io={AlreadyOpen:"alreadyopen"};function Rh(i){return i.getMetrics()}function bt(i,e,t=""){return Ne(i,e,t)??t}function Nh(i){const e=i??{};return e.alpha=tt(e,"alpha",E.MessagePanel.DimBack.Alpha),e.color=bt(e,"color",E.MessagePanel.DimBack.Color),e}function $h(i){const e=i??{};return e.buttonLabels??(e.buttonLabels={}),e.dimBack=Nh(e.dimBack),e}const Bt=class Bt{static Clear(e){(!e||e===Bt.Instance)&&(Bt.Instance=void 0)}static Get(){return Bt.Instance}static Set(e){Bt.Instance=e}constructor(){throw new Error("Instances of SbMessagePanelSingleton may not be created.")}};a(Bt,"Instance");let $t=Bt;const ai={BackDisplay:"back",MessageText:"txtMessage",TextAreaNode:"textAreaNode"};class Ct extends Z{constructor(t,n,r,s){super(n);a(this,"shouldCloseAfterSelection");a(this,"buttonIdsByButton");a(this,"config");a(this,"stage");a(this,"dimBack");a(this,"isOpen");a(this,"dragManager");a(this,"_autoCloseDelayConfig");a(this,"autoCloseTimer");a(this,"textMessage");a(this,"back");a(this,"textAreaNode");a(this,"promisedResolve");$t.Set(this),this.config=$h(s),this.stage=t,this.dimBack=this.createDimBack(),this.textMessage=ei(this.display,ai.MessageText,r),this.back=Re(this.display,ai.BackDisplay),this.buttonIdsByButton=this.initButtons(),this.textAreaNode=this.initTextAreaNode(),this.back&&(this.dragManager=new Qs(this.display,this.back)),this._autoCloseDelayConfig=Ct.BuildAutoCloseDelayConfig(this.config.autoClose),this.shouldCloseAfterSelection=!0,this.isOpen=!1,this.alignTextVerticlally()}get autoCloseDelayConfig(){return this._autoCloseDelayConfig}set autoCloseDelayConfig(t){this._autoCloseDelayConfig=Ct.BuildAutoCloseDelayConfig(t)}static Create(t,n,r,s){if($t.Instance)return new Promise((c,h)=>{h(io.AlreadyOpen)});const o=new r,l=new Ct(t,o,n,s),{canvasSize:u}=l;return u&&l.setPosition(u.width/2,u.height/2),l.open()}close(t=et.Close){this.isOpen&&(this.isOpen=!1,this.autoCloseTimer&&(this.autoCloseTimer.stop(),this.autoCloseTimer=void 0),this.stage.removeChild(this.dimBack,this.display),this.dispatchPromsedResolve(t),$t.Clear(this),this.emit(oi.CLOSE,this))}dispose(){var t;super.dispose(),this.close(),(t=this.dragManager)==null||t.dispose(),this.dragManager=void 0,this.dimBack.removeAllEventListeners(),this.disposeButtons()}async open(){return new Promise((t,n)=>{if(this.isOpen){n(io.AlreadyOpen);return}this.isOpen=!0,this.promisedResolve=t,this.stage.addChild(this.dimBack,this.display),this._autoCloseDelayConfig&&(this.autoCloseTimer=dt.Create({callback:()=>{var r;this.close(((r=this._autoCloseDelayConfig)==null?void 0:r.buttonId)??et.Close)},delayMs:this._autoCloseDelayConfig.delayMs}))})}setAutoCloseDelay(t=null){return this._autoCloseDelayConfig=Ct.BuildAutoCloseDelayConfig(t??void 0),this}setText(t){return this.textMessage&&(this.textMessage.text=t),this.alignTextVerticlally(),this}alignTextVerticlally(){const{textAreaNode:t,textMessage:n}=this;if(n&&t){const r=Rh(n),s=n.getMeasuredLineHeight()*r.lines.length;n.y=t.y+(t.height-s)/2}}get canvas(){const t=this.stage.canvas;return t instanceof HTMLCanvasElement?t:document.getElementById(t)}get canvasSize(){const{canvas:t}=this;if(t)return{width:t.width/this.stage.scaleX,height:t.height/this.stage.scaleY}}createDimBack(){const t=new createjs.Shape;return t.on(m.CLICK,()=>{}),this.renderDimBack(t),t}dispatchPromsedResolve(t){this.promisedResolve&&t&&(this.promisedResolve(t),this.promisedResolve=void 0)}disposeButtons(){this.buttonIdsByButton.forEach((t,n)=>{n.dispose()}),this.buttonIdsByButton.clear()}static BuildAutoCloseDelayConfig(t){if(t)return t===!0?{buttonId:E.MessagePanel.AutoClose.ButtonId,delayMs:E.MessagePanel.AutoClose.DelayMs}:{buttonId:t.buttonId??E.MessagePanel.AutoClose.ButtonId,delayMs:t.delayMs}}initButton(t,n){const r=mt(this.display,`${t}ButtonDisplay`,this.onButtonPressed,void 0,this);return r&&n&&(r.buttonLabelText=n),r}initButtons(){const t=new Map;return Po.forEach(n=>{const r=this.initButton(n,this.config.buttonLabels[n]);r&&t.set(r,n)}),t}initTextAreaNode(){const t=pt(this.display,ai.TextAreaNode);if(!t)return;const n=t.getTransformedBounds().clone();return t.visible=!1,n}onButtonPressed(t){const n=this.buttonIdsByButton.get(t);this.emit(oi.COMPLETE,n,this),this.dispatchPromsedResolve(n),this.shouldCloseAfterSelection&&this.dispose()}renderDimBack(t){const{canvasSize:n}=this;n&&(t.alpha=this.config.dimBack.alpha,t.graphics.clear().beginFill(this.config.dimBack.color).drawRect(0,0,n.width,n.height).endFill())}}const li={SUBMIT:"submit"};function ro(i,e){return i+Math.floor(Math.random()*(e-i+1))}function Lh(){const i=ro(1,9),e=ro(0,i),t=i-e;return{expression:`${e} + ${t}`,value:i}}class Hh extends Rt{constructor(t,n){var r;super(t,n);a(this,"numberButtons");a(this,"txtChallenge");a(this,"txtChallengeAnswer");a(this,"clearButton");a(this,"submitButton");a(this,"feedbackTween");a(this,"challengeData");a(this,"origTextColor");a(this,"answer");this.numberButtons=this.initNumberButtons(),this.submitButton=this.initSubmitButton(),this.clearButton=this.initClearButton(),this.txtChallenge=this.initChallengeText("txtChallenge"),this.txtChallengeAnswer=this.initChallengeText("txtChallengeAnswer"),this.origTextColor=((r=this.txtChallengeAnswer)==null?void 0:r.color)??"#000",this.answer=0}clearAnswer(){return this.answer=0,this.updateAfterResponse(),this}present(){var t;return this.refreshChallenge(),(t=this.submitButton)==null||t.setEnabled(!0),this.visible=!0,this}unpresent(){var t;return this.disposeFeedbackTween(),(t=this.submitButton)==null||t.setEnabled(!1),this.visible=!1,this}onInit(){super.onInit(this.engine.lib.animateClasses.CloseXButtonHitBoxDisplay)}addNumberOntoAnswer(t){let n=this.answer+t.toString(10);n=n.substring(n.length-1),this.answer=Number.parseInt(n,10)}disposeFeedbackTween(){this.feedbackTween&&(createjs.Tween.removeTweens(this.feedbackTween.target),this.feedbackTween=void 0)}enableNumberButtons(t){this.numberButtons.forEach(n=>{n.enabled=t})}feedbackIncorrect(){var t;this.flashAnswerText("#f00"),(t=this.feedbackTween)==null||t.call(()=>{var n;(n=this.submitButton)==null||n.setEnabled(!0),this.emit(li.SUBMIT,!1,this)})}feedbackCorrect(){var t;this.flashAnswerText("#0f0"),(t=this.feedbackTween)==null||t.call(()=>{this.emit(li.SUBMIT,!0,this)})}flashAnswerText(t){if(!this.txtChallengeAnswer)return;this.disposeFeedbackTween();const n=this.txtChallengeAnswer;this.feedbackTween=createjs.Tween.get(n);for(let r=0;r<7;r+=1)this.feedbackTween.call(()=>{n.color=t}).wait(60).call(()=>{n.color=this.origTextColor}).wait(60)}initChallengeText(t){const n=this.initText(t);return n&&(n.visible=!1),n}initClearButton(){return this.initCompoundButton("passcodeButtonClear",this.onClearPressed)}initNumberButtons(){const t=[];let n=1,r=this.initCompoundButton(`passcodeButton${n}`,this.onNumberButtonPressed,void 0,this.engine.lib.animateClasses.PasscodeButtonBackDisplay);for(;r;)t.push(r),n+=1,r=this.initCompoundButton(`passcodeButton${n}`,this.onNumberButtonPressed);return t}initSubmitButton(){return this.initCompoundButton("passcodeButtonSubmit",this.onSubmitPressed)}onClearPressed(){this.clearAnswer()}onNumberButtonPressed(t){const n=this.numberButtons.indexOf(t);n>-1&&(this.addNumberOntoAnswer(n+1),this.updateAfterResponse())}onSubmitPressed(){var n;(n=this.submitButton)==null||n.setEnabled(!1),this.challengeData!==void 0&&this.answer===this.challengeData.value?this.feedbackCorrect():this.feedbackIncorrect()}refreshChallenge(){this.challengeData=Lh(),this.txtChallenge&&(this.txtChallenge.text=`${this.challengeData.expression}?`,this.txtChallenge.visible=!0),this.answer=0,this.updateAfterResponse()}updateAfterResponse(){this.txtChallengeAnswer&&(this.txtChallengeAnswer.text=this.answer!==0?this.answer.toString(10):"",this.txtChallengeAnswer.visible=!0),this.enableNumberButtons(this.answer>-100&&this.answer<100)}}function jh(i,e,t,n,r,s){const o=Re(i,e);if(!o)return;const l=new Js(o,r,s);return t&&l.on(rt.CHANGED,t,n),l}class ui{constructor(e,t){a(this,"areSettingsDirty");a(this,"mainPanel");a(this,"lib");a(this,"_settings");this.mainPanel=e,this.lib=t,this.areSettingsDirty=!1}get settings(){return this._settings}setSettings(e){return this._settings=e,this.updateSettingsUiFromData(),this.areSettingsDirty=!1,this}setSettingProp(e,t,n){return e!==void 0&&(e[t]=n),this.areSettingsDirty=!0,this}}class Uh extends ui{constructor(t,n){super(t,n);a(this,"sliderCheckboxPairs");a(this,"settingDataKeysByUiControl");this.settingDataKeysByUiControl=new Map,this.sliderCheckboxPairs=this.initSliderCheckboxPairs(),this.initSoundSlider(),this.initVoiceSlider(),this.initBgmSlider(),this.initBgmCheckbox()}updateSettingsUiFromData(){const{settings:t}=this;t&&Zs.forEach(n=>{var l,u;const r=t[n],s=r.isEnabled,o=this.sliderCheckboxPairs[n];(l=o.checkbox)==null||l.setOn(s),(u=o.slider)==null||u.setValue(s?r.volume:0)})}getCheckbox(t){return this.sliderCheckboxPairs[t].checkbox}getSlider(t){return this.sliderCheckboxPairs[t].slider}initBgmCheckbox(){const t=this.getCheckbox(st.Bgm);t&&t.on(j.PRESSED,this.onBgmCheckboxPressed,this)}initBgmSlider(){const t=this.getSlider(st.Bgm);t&&t.on(rt.CHANGED,this.onBgmSliderChanged,this)}initSliderCheckboxPairs(){const{container:t}=this.mainPanel,n={};return Zs.forEach(r=>{const s=this.mainPanel.initCheckbox(`${r}CheckboxDisplay`,this.onCheckboxPressed,!1,t,this),o=jh(t,`${r}SliderDisplay`,this.onSliderChanged,this);n[r]={checkbox:s,slider:o},s&&this.settingDataKeysByUiControl.set(s,r),o&&this.settingDataKeysByUiControl.set(o,r)}),n}initSoundSlider(){const t=this.getSlider(st.Sound);t&&t.on(rt.DRAG_STOPPED,this.onSoundSliderDragStopped,this)}initVoiceSlider(){const t=this.getSlider(st.Voice);t&&t.on(rt.DRAG_STOPPED,this.onVoiceSliderDragStopped,this)}onBgmCheckboxPressed(){this.updateBgmVolume()}onBgmSliderChanged(){this.updateBgmVolume()}onCheckboxPressed(t){var l;const n=t,r=this.settingDataKeysByUiControl.get(n);if(!r||!this.settings)return;const s=this.settings[r];this.setSettingProp(s,"isEnabled",n.isOn),(l=this.sliderCheckboxPairs[r].slider)==null||l.setValue(n.isOn?s.volume:0,!1)}onSliderChanged(t){var l;const n=this.settingDataKeysByUiControl.get(t);if(!n||!this.settings)return;const r=t.value>0;(l=this.sliderCheckboxPairs[n].checkbox)==null||l.setOn(r);const o=this.settings[n];this.setSettingProp(o,"isEnabled",r),this.setSettingProp(o,"volume",t.value)}onSoundSliderDragStopped(){var t;this.mainPanel.engine.playSound(this.lib.audioIds.VolumeTest,(t=this.settings)==null?void 0:t.sound.volume)}onVoiceSliderDragStopped(){var t;this.mainPanel.engine.playSound(this.lib.audioIds.VolumeTest,(t=this.settings)==null?void 0:t.voice.volume)}updateBgmVolume(){this.settings&&this.mainPanel.engine.setBgmVolume(this.settings.bgm.isEnabled?this.settings.bgm.volume:0)}}const Le={SELECTED:"selected"};class ci extends X{constructor(t){super();a(this,"radioButtonIdsByButton");a(this,"_isEnabled");this.radioButtonIdsByButton=new Map,this._isEnabled=!0,t==null||t.forEach(([n,r])=>{this.add(n,r)})}add(t,n){return this.radioButtonIdsByButton.has(n)||n.addListener(j.PRESSED,this.onButtonPressed,this),this.radioButtonIdsByButton.set(n,t),this}dispose(){this.removeAllButtons(),this.removeAllListeners()}get enabled(){return this._isEnabled}set enabled(t){this._isEnabled=t,this.radioButtonIdsByButton.forEach((n,r)=>{r.enabled=t})}removeAllButtons(){return this.radioButtonIdsByButton.forEach(t=>{this.removeButton(t)}),this}removeButton(t){const n=this.resolveButton(t);return n&&(n.removeListener(j.PRESSED,this.onButtonPressed,this),this.radioButtonIdsByButton.delete(n)),this}setButtonOn(t){return this.setButtonState(t,!0)}setButtonState(t,n){const r=this.resolveButton(t);return r&&(r.setOn(n),this.update(r)),this}setEnabled(t){return this.enabled=t,this}shouldUseDisabledStates(t){return this.radioButtonIdsByButton.forEach((n,r)=>{r.shouldUseDisabledState=t}),this}onButtonPressed(t){const n=this.radioButtonIdsByButton.get(t);n!==void 0&&(this.update(t),this.emit(Le.SELECTED,n,t,this))}resolveButton(t){if(typeof t=="string"||typeof t=="number"){const n=this.radioButtonIdsByButton.entries();let r=n.next();for(;!r.done;){const[s,o]=r.value;if(o===t)return s;r=n.next()}return}return this.radioButtonIdsByButton.has(t)?t:void 0}setOnAndDisableOtherButtons(t){this.radioButtonIdsByButton.forEach((n,r)=>{r!==t&&r.setOn(!1).setEnabled(this.enabled)})}update(t){t.isOn&&(t.enabled=!1,this.setOnAndDisableOtherButtons(t))}}const Vh=[[Y.DualSwitch,"dualSwitchCheckboxDisplay"],[Y.EyeTracker,"eyeTrackerCheckboxDisplay"],[Y.SingleSwitch,"singleSwitchCheckboxDisplay"],[Y.TapMouse,"tapMouseCheckboxDisplay"]];class so extends ui{constructor(t,n){super(t,n);a(this,"devicesRadioGroup");this.devicesRadioGroup=this.initDevicesRadioGroup()}updateFromSettings(){return this.settings&&this.devicesRadioGroup.setButtonOn(this.settings.inputDevice),this}updateSettingsUiFromData(){this.updateFromSettings()}initDevicesRadioGroup(){const t=[];Vh.forEach(([r,s])=>{const o=this.mainPanel.initCheckbox(s);o&&t.push([r,o])});const n=new ci(t);return n.addListener(Le.SELECTED,this.onDevicesRadioGroupSelected,this),n}onDevicesRadioGroupSelected(t){this.setSettingProp(this.settings,"inputDevice",t)}}class Lt{constructor(e){a(this,"checkbox");a(this,"onFill");a(this,"offFill");this.checkbox=e,this.onFill=Lt.GetFillDisplay(this.checkbox.onButton),this.offFill=Lt.GetFillDisplay(this.checkbox.offButton)}setColor(e){return Lt.ApplyColorToFill(this.onFill,e),Lt.ApplyColorToFill(this.offFill,e),this}static ApplyColorToFill(e,t){if(!e)return;const n=w.CaptionHilites.Stroke;e.display.graphics.clear().setStrokeStyle(n.Thickness).beginStroke(n.Color).beginFill(t).drawRect(0,0,e.bounds.width,e.bounds.height)}static GetFillDisplay(e){if(!((e==null?void 0:e.display)instanceof createjs.MovieClip))return;const t=P(e.display,"fill_display");if(!t)return;const n=P(t,"fill_placeholder");if(!n)return;const r=n.getBounds();if(!r)return;t.removeChild(n);const s=new createjs.Shape;return s.regX=r.width/2,s.regY=r.height/2,t.addChild(s),{bounds:r.clone(),display:s}}}const oo="off",Ht="on";class Gh extends ui{constructor(t,n){super(t,n);a(this,"captionHiliteColorRadioGroup");a(this,"helpfulTipsRadioGroup");a(this,"captionsRadioGroup");a(this,"captionHilitesRadioGroup");a(this,"aacRadioGroup");this.helpfulTipsRadioGroup=this.initRadioGroup("helpfulTipsOffButtonDisplay","helpfulTipsOnButtonDisplay",this.onHelpfulTipsGroupSelected),this.captionsRadioGroup=this.initRadioGroup("captionsOffButtonDisplay","captionsOnButtonDisplay",this.onCaptionsGroupSelected),this.captionHilitesRadioGroup=this.initRadioGroup("captionHilitesOffButtonDisplay","captionHilitesOnButtonDisplay",this.onCaptionHilitesGroupSelected),this.captionHiliteColorRadioGroup=this.initCaptionHiliteColorCheckboxes(),this.aacRadioGroup=this.initRadioGroup("aacOffButtonDisplay","aacOnButtonDisplay",this.onAacGroupSelected),this.updateSettingsUiFromData()}updateSettingsUiFromData(){this.settings&&this.updateRadioGroup(this.aacRadioGroup,this.settings.aacSymbolsEnabled).updateRadioGroup(this.captionsRadioGroup,this.settings.captionsEnabled).updateRadioGroup(this.helpfulTipsRadioGroup,this.settings.helpfulTipsEnabled).updateCaptionHilitesRadioGroup().updateHiliteColorRadioGroup()}updateCaptionHilitesRadioGroup(){var t;return this.updateRadioGroup(this.captionHilitesRadioGroup,((t=this.settings)==null?void 0:t.captionHilitesEnabled)===!0).updateCaptionHilitesRadioGroupEnabledState()}initCaptionHiliteColorCheckbox(t){const n=qs(this.mainPanel.container,t,!1,void 0,void 0,this.lib.animateClasses.RadioButtonHitBoxDisplay);return n?new Lt(n):void 0}initCaptionHiliteColorCheckboxes(){const t=[];let n=0,r=this.initCaptionHiliteColorCheckbox(`hiliteColor${n}CheckboxDisplay`);for(;r;){const o=w.CaptionHilites.Colors[n];o&&r.setColor(o),r.checkbox.shouldUseDisabledState=!1,t.push([n,r.checkbox]),n+=1,r=this.initCaptionHiliteColorCheckbox(`hiliteColor${n}CheckboxDisplay`)}const s=new ci(t);return s.addListener(Le.SELECTED,this.onCaptionHiliteColorCheckboxPressed,this),s}initRadioGroup(t,n,r){const s=this.initCaptionHiliteColorCheckbox(t),o=this.initCaptionHiliteColorCheckbox(n),l=[];s&&l.push([oo,s.checkbox]),o&&l.push([Ht,o.checkbox]);const u=new ci(l);return u.addListener(Le.SELECTED,r,this),u.shouldUseDisabledStates(!1),u}onAacGroupSelected(t){this.setSettingProp(this.settings,"aacSymbolsEnabled",t===Ht)}onCaptionHiliteColorCheckboxPressed(t){this.setSettingProp(this.settings,"captionHiliteColorIndex",t)}onCaptionHilitesGroupSelected(t){var r;this.setSettingProp(this.settings,"captionHilitesEnabled",t===Ht);const n=((r=this.settings)==null?void 0:r.captionHilitesEnabled)===!0;this.captionHiliteColorRadioGroup.enabled=n,this.captionHiliteColorRadioGroup.shouldUseDisabledStates(!n)}onCaptionsGroupSelected(t){const n=t===Ht;this.setSettingProp(this.settings,"captionsEnabled",n),this.updateCaptionHilitesRadioGroupEnabledState(),this.updateCaptionHiliteColorRadioGroupEnabledState(),n||(this.updateRadioGroup(this.captionHilitesRadioGroup,!1),this.setSettingProp(this.settings,"captionHilitesEnabled",!1))}onHelpfulTipsGroupSelected(t){this.setSettingProp(this.settings,"helpfulTipsEnabled",t===Ht)}updateCaptionHiliteColorRadioGroupEnabledState(){const t=this.settings!==void 0&&this.settings.captionsEnabled&&this.settings.captionHilitesEnabled;this.captionHiliteColorRadioGroup.enabled=t,this.captionHiliteColorRadioGroup.shouldUseDisabledStates(!t)}updateCaptionHilitesRadioGroupEnabledState(){var n;const t=((n=this.settings)==null?void 0:n.captionsEnabled)===!0;return this.captionHilitesRadioGroup.enabled=t,this.captionHilitesRadioGroup.shouldUseDisabledStates(!t),this}updateHiliteColorRadioGroup(){var t;return((t=this.settings)==null?void 0:t.captionHiliteColorIndex)!==void 0&&this.captionHiliteColorRadioGroup.setButtonOn(this.settings.captionHiliteColorIndex),this.updateCaptionHiliteColorRadioGroupEnabledState(),this}updateRadioGroup(t,n){const r=n?Ht:oo;return t.setButtonOn(r),this}}const He={EXIT:"exit",SAVE:"save"};class Kh extends Rt{constructor(t,n){super(t,n);a(this,"audioSubPanel");a(this,"devicesSubPanel");a(this,"storybookSubPanel");a(this,"_settingsData");this.audioSubPanel=new Uh(this,n.lib),this.devicesSubPanel=new so(this,n.lib),this.storybookSubPanel=new Gh(this,n.lib),this.initButton("saveButtonDisplay",this.onSavePressed),this.initButton("exitButtonDisplay",this.onExitPressed),this._settingsData=F(E.Settings)}get settingsData(){return this._settingsData}set settingsData(t){this._settingsData=t,this.audioSubPanel.setSettings(this._settingsData.audio),this.devicesSubPanel.setSettings(this._settingsData.device),this.storybookSubPanel.setSettings(this._settingsData.storybook)}present(t){return this.settingsData=t,this.visible=!0,this}resetModifiedFlags(){return this.audioSubPanel.areSettingsDirty=!1,this.devicesSubPanel.areSettingsDirty=!1,this.storybookSubPanel.areSettingsDirty=!1,this}unpresent(){return this.visible=!1,this}async onClosePressed(){await this.shouldConitnueWithUnsavedChanges()&&this.emit(it.CLOSE,this)}onInit(){super.onInit(this.engine.lib.animateClasses.CloseXButtonHitBoxDisplay)}areSettingsDirty(){return this.audioSubPanel.areSettingsDirty||this.devicesSubPanel.areSettingsDirty||this.storybookSubPanel.areSettingsDirty}async shouldConitnueWithUnsavedChanges(){return this.areSettingsDirty()?await this.engine.createMessagePanel(`You have unsaved changes.
Continue to close settings?`,this.engine.lib.animateClasses.MessagePanelYNDisplay)===et.Yes:!0}async onExitPressed(){await this.shouldConitnueWithUnsavedChanges()&&this.emit(He.EXIT,this)}onSavePressed(){this.emit(He.SAVE,this)}}const Jt={IsFromNav:"isFromNav",IsFromUi:"isFromUi"};class Wh extends X{constructor(t,n){super();a(this,"engine");a(this,"timelineStartFrame");a(this,"contentVideoBitmap");a(this,"buffer");a(this,"_videoElement");this.engine=t,this.timelineStartFrame=0,this._videoElement=n,n&&this.init(n)}dispose(){var t,n;this.removeAllListeners(),this.stop(),(n=(t=this.contentVideoBitmap)==null?void 0:t.parent)==null||n.removeChild(this.contentVideoBitmap),this.contentVideoBitmap=void 0}init(t){var r;return this.contentVideoBitmap?this:((r=this.engine.config)!=null&&r.shouldUseVideoBuffer&&(this.buffer=new createjs.VideoBuffer(t)),this.contentVideoBitmap=new createjs.Bitmap(this.buffer||t),this.contentVideoBitmap.visible=!1,(this.engine.videoContainer||this.engine.exportRoot.display).addChildAt(this.contentVideoBitmap,0),this)}async play(){if(!this._videoElement||this._videoElement.ended)return!1;try{await this._videoElement.play()}catch(t){return console.warn(t),!1}return!0}seekTo(t){return this._videoElement&&(this._videoElement.currentTime=t),this}seekToFrame(t){if(!this._videoElement)return this;const r=Math.max(0,t-this.timelineStartFrame)/this.engine.config.videoFps;return this.seekTo(r)}setVisible(t){return this.contentVideoBitmap&&(this.contentVideoBitmap.visible=t),this}stop(){var t;return(t=this._videoElement)==null||t.pause(),this}get videoElement(){return this._videoElement}}const zh={VIDEO_LOAD_COMPLETE:"videoLoadComplete"};class qh{constructor(e){a(this,"engine");this.engine=e}convertTimelineFrameToVideoTime(e){return Math.max(0,this.resolveTimelineFrame(e)-this.startTimelineFrame)/this.engine.config.videoFps}resolveTimelineFrame(e){return typeof e=="number"?e:this.exportRoot.timeline.resolve(e)??0}resolveVideoTime(e){e||(e={timelineFrame:0,videoFrame:0,videoTimeSecs:0});const{contentVideoElement:t}=this;return t&&(e.timelineFrame=this.exportRoot.currentFrame-this.startTimelineFrame,e.videoTimeSecs=t.currentTime,e.videoFrame=Math.ceil(e.videoTimeSecs*this.engine.config.videoFps)),e}get contentVideoElement(){return this.engine.contentVideoElement}get exportRoot(){return this.engine.exportRoot}get startTimelineFrame(){return this.engine.startTimelineFrame}}function Xh(i){return O(i)&&("action"in i||"callback"in i||"frame"in i)}const hi={Play:"play",Stop:"stop"},{ContentVideoId:ao}=w;class Yh extends X{constructor(t){super();a(this,"engine");a(this,"pauseConfig");a(this,"videoMath");a(this,"contentVideoLastTime");a(this,"contentVideo");a(this,"videoTimeProps");this.engine=t,this.pauseConfig={isFromNav:!1,isFromUi:!1},this.contentVideoLastTime=-1,this.videoMath=new qh(t)}get videoElement(){var t;return(t=this.contentVideo)==null?void 0:t.videoElement}dispose(){this.contentVideo?(this.contentVideo.dispose(),this.contentVideo=void 0):this.exportRoot.stop()}loadContentVideo(t){if(this.contentVideo)return this;const n=new createjs.LoadQueue;return n.on(m.FILE_LOAD,r=>{const s=r;s.item.id===ao&&this.setContentVideo(s.result)},this),n.on(m.COMPLETE,()=>{n.destroy(),this.emit(zh.VIDEO_LOAD_COMPLETE,this)},this,!0),n.loadFile({id:ao,src:t,type:"video"},!0),this}navTo(t,n){const r=n[t];if(r===void 0){this.resume(Jt.IsFromNav);return}let s;if(Xh(r)?s=r:s={action:hi.Play,frame:r},s.callback!==void 0){s.callback.call(s.context);return}const o=s.frame;if(o===void 0){this.resume(Jt.IsFromNav);return}const l=this.exportRoot.timeline.resolve(o);this.contentVideo&&s.action?this.navToJumpVideo(l,s.action):this.navToJumpRoot(l,s)}pause(t){return this.pauseTarget(t),this}resume(t,n,r){return this.resumeTarget(t,n,r),this}setContentVideo(t){return this.contentVideo?(console.info("A content video has already been set."),this):(this.contentVideo=new Wh(this.engine,t),this)}start(t){var r;const n=t??this.startTimelineFrame;return(r=this.contentVideo)!=null&&r.videoElement?this.startWithVideo(n):this.startWithTimeline(n),this.engine.updateFromSettings(),this}update(){var t;(t=this.contentVideo)!=null&&t.videoElement&&(this.videoTimeProps=this.videoMath.resolveVideoTime(this.videoTimeProps))}get exportRoot(){return this.engine.exportRoot}navToJumpRoot(t,n){console.log("navToJumpRoot:",t,this.exportRoot.currentFrame,"param:",n),n.action===hi.Play?this.resume(Jt.IsFromNav,t,n.endFrame):this.exportRoot.stop(t)}navToJumpVideo(t,n){var r,s;this.exportRoot.stop(t),n===hi.Play?(r=this.contentVideo)!=null&&r.videoElement&&(this.contentVideo.seekToFrame(t),this.contentVideoLastTime=this.contentVideo.videoElement.currentTime,this.resume(Jt.IsFromNav)):(s=this.contentVideo)!=null&&s.videoElement&&(this.contentVideo.seekToFrame(t),this.contentVideoLastTime=this.contentVideo.videoElement.currentTime)}pauseTarget(t){this.pauseConfig[t]=!0,this.contentVideo?this.contentVideo.stop():(console.log("pause target",this.exportRoot.currentFrame,this.exportRoot.display.currentLabel),this.exportRoot.stop())}async resumeTarget(t,n,r){this.pauseConfig[t]=!1,!(this.pauseConfig.isFromNav||this.pauseConfig.isFromUi)&&(this.contentVideo?(n!==void 0&&this.exportRoot.stop(n),this.contentVideo.play()):(console.log("resume target",this.exportRoot.currentFrame,this.exportRoot.display.currentLabel,n!==void 0?`starting from: ${n}`:""),n!==void 0?r!==void 0?this.exportRoot.playTo(r,n):this.exportRoot.play(n):this.exportRoot.play()))}get startTimelineFrame(){return this.engine.startTimelineFrame}startWithTimeline(t){const{config:n}=this.engine;n.startCallback&&n.startCallback.call(n.startCallbackContext)}startWithVideo(t){var n;(n=this.contentVideo)!=null&&n.videoElement&&(this.exportRoot.stop(t),this.contentVideo.videoElement.currentTime=this.videoMath.convertTimelineFrameToVideoTime(t),this.contentVideo.play(),this.contentVideo.setVisible(!0))}}function je(i){const e=window.location.search;return new URLSearchParams(e).get(i)}const Ue={ContentVideo:"contentVideo",DeleteProgress:"deleteProgress",ExitRedirect:"exitRedirect",StorybookId:"storybookId"};function lo(){const i=Object.keys(AdobeAn.compositions)[0];return i?AdobeAn.compositions[i]:void 0}function Qh(i){return i??(i=lo()),i==null?void 0:i.getLibrary()}let _;function Jh(i){const e=i??[];return["canvas","_preload_div_","animation_container","dom_overlay_container"].forEach((t,n)=>{e[n]||(e[n]=document.getElementById(t))}),e}function uo(){const i=Qh();if(!i)return;const e=i.properties.width,t=i.properties.height,n=window.innerWidth,r=window.innerHeight,s=window.devicePixelRatio||1,o=n/e,l=r/t;let u=1;_.isResp&&(_.respDim==="width"&&_.lastW===n||_.respDim==="height"&&_.lastH===r?u=_.lastS:_.isScale?_.scaleType===1?u=Math.min(o,l):_.scaleType===2&&(u=Math.max(o,l)):(n<e||r<t)&&(u=Math.min(o,l)));const{domContainers:c}=_;c.forEach((h,d)=>{h&&(d===0&&h instanceof HTMLCanvasElement?(h.width=e*s*u,h.height=t*s*u):(h.style.width=`${e*u}px`,h.style.height=`${t*u}px`))}),_.lastW=n,_.lastH=r,_.lastS=u,stage&&(stage.scaleX=s*u,stage.scaleY=s*u,stage.tickOnUpdate=!1,stage.update(),stage.tickOnUpdate=!0)}function Zh(i=!0,e="both",t=!1,n=1){_={domContainers:Jh(),isResp:i,respDim:e,isScale:t,scaleType:n,lastH:0,lastS:1,lastW:0},window.addEventListener(ii.Resize,uo),uo()}function td(i){const e=je(Ue.ContentVideo);e&&i.loadFile({id:w.ContentVideoId,src:e,type:"video"})}function ed(i){const e=document.getElementById(w.HtmlElementIds.ProgressBarFill);if(e){const t=Math.round((1-R(i,0,1))*100);e.style.right=`${t}%`}}function nd(){canvas=document.getElementById(w.HtmlElementIds.Canvas),anim_container=document.getElementById(w.HtmlElementIds.AnimationContainer),dom_overlay_container=document.getElementById(w.HtmlElementIds.DomOverlayContainer);const i=lo();if(!i){console.warn("no compoision library found");return}const e=i.getLibrary(),t=new createjs.LoadQueue(!1);t.installPlugin(createjs.Sound),t.addEventListener(m.PROGRESS,n=>{ed(n.progress)}),t.addEventListener(m.FILE_LOAD,n=>{const r=n;r.item.id===w.ContentVideoId?e.contentVideo=r.result:handleFileLoad(n,i)}),t.addEventListener(m.COMPLETE,n=>{handleComplete(n,i),t.destroy()}),t.loadManifest(e.properties.manifest),td(t),Zh()}function Ve(i,e,t=!1){return Ne(i,e,t)??t}function id(i){const e=i??{};return e.defaultCorrectSoundKey=bt(i,"defaultCorrectSoundKey"),e.defaultInorrectSoundKey=bt(i,"defaultInorrectSoundKey"),e}const U=E.EngineConfig;function rd(i){return bt(i,"storybookId")||(je(Ue.StorybookId)??"")}function sd(i,e){const t=tt(i,"videoFps",e==null?void 0:e.header.properties.fps);return t>0?t:U.videoFps}function od(i,e,t){return t??(t={}),t.buttonsMenu=id(i==null?void 0:i.buttonsMenu),t.contentVideoUrl=bt(i,"contentVideoUrl",U.contentVideoUrl),t.exitRedirectUrl=bt(i,"exitRedirectUrl",U.exitRedirectUrl),t.navButtonsSoundKey=bt(i,"navButtonsSoundKey",U.navButtonsSoundKey),t.pressIndicatorDelay=tt(i,"pressIndicatorDelay",U.pressIndicatorDelay),t.sceneHandler=Ne(i,"sceneHandler",U.sceneHandler),t.shouldSkipIntro=Ve(i,"shouldSkipIntro",U.shouldSkipIntro),t.shouldUseVideoBuffer=Ve(i,"shouldUseVideoBuffer",U.shouldUseVideoBuffer),t.shouldWaitForNavSounds=Ve(i,"shouldWaitForNavSounds",U.shouldWaitForNavSounds),t.singleDeviceDelayMs=tt(i,"singleDeviceDelayMs",U.singleDeviceDelayMs),t.startCallback=(i==null?void 0:i.startCallback)??U.startCallback,t.startCallbackContext=(i==null?void 0:i.startCallbackContext)??U.startCallbackContext,t.storybookId=rd(i),t.videoFps=sd(i,e),t}function ad(i){return(i&1)===0}function ld(i){return!ad(i)}function ud(i){const e=i??{};return e.numShakes=tt(e,"numShakes",8),e.shouldUseTicks=Ve(e,"shouldUseTicks",!0),e.tiltIntensityInDegrees=tt(e,"tiltIntensityInDegrees",2),e.tremorIntensity=tt(e,"tremorIntensity",5),e.waitDuration=tt(e,"waitDuration",e.shouldUseTicks?1:25),e}function cd(i,e){const t=i instanceof Z?i.display:i,n=ud(e),r=createjs.Tween.get(t,{useTicks:n.shouldUseTicks}),s={rotation:t.rotation,x:t.x,y:t.y};for(let o=0;o<n.numShakes;o+=1){o>0&&r.wait(n.waitDuration);const l=ld(o)?-1:1;r.to({rotation:s.rotation+n.tiltIntensityInDegrees*l,x:s.x+Math.random()*(n.tremorIntensity*l),y:s.y+Math.random()*(n.tremorIntensity*l)})}r.wait(n.waitDuration).to({rotation:s.rotation,x:s.x,y:s.y})}function hd(i){const e=i??{};return{callback:e.callback,callbackContext:e.callbackContext,incorrectConfig:e.incorrectConfig,isCorrect:e.isCorrect,isDisabled:e.isDisabled,isHidden:e.isHidden}}const di={OPTION_SELECTED:"optionSelected"};class Zt extends X{constructor(t){super();a(this,"quizData");a(this,"buttonsByConfig");a(this,"buttonsOrder");a(this,"engine");a(this,"inputDeviceHandler");a(this,"selectedButtonIndex");a(this,"config");this.engine=t,this.buttonsByConfig=new Map,this.buttonsOrder=[],this.inputDeviceHandler=this.initInputDeviceHandler(),this.selectedButtonIndex=-1}dispose(){super.removeAllListeners(),this.uninitResources()}resolveConfigs(t){const n=t.buttons??{},r={buttons:n,buttonsContainer:t.buttonsContainer,correctSoundKey:t.correctSoundKey,defaultButtonName:t.defaultButtonName,incorrectSoundKey:t.incorrectSoundKey,isQuiz:t.isQuiz,shouldCloseMenu:t.shouldCloseMenu??!0};return this.config=r,{buttonConfigsByName:n,thisConfig:r}}start(t){const n=this.resolveConfigs(t);return this.initButtonsFromConfigs(n),this.inputDeviceHandler.isEnabled=this.inputDeviceHandler.isSingleSwitchEnabled()||this.inputDeviceHandler.isDualSwitchEnabled(),this.initDefaultSelectedButton(n.thisConfig),this.quizData=n.thisConfig.isQuiz?{numAttempts:0,totalSelection:Zt.GetNumQuizbuttons(n),percentageCorrect:0}:void 0,this}static GetNumQuizbuttons(t){return Object.values(t.buttonConfigsByName).filter(r=>r?r.isCorrect!==void 0:!1).length}updateFromSettings(){this.inputDeviceHandler.setEnabled(this.inputDeviceHandler.isSingleSwitchEnabled()||this.inputDeviceHandler.isDualSwitchEnabled()).updateFromSettings()}confirmSelectedButton(){const{selectedButton:t}=this;t&&this.onButtonPressed(t)}disposeButtons(){this.buttonsByConfig.forEach(t=>{t.dispose()}),this.buttonsByConfig.clear(),this.buttonsOrder.length=0}getDefaultSelectedButtonIndex(t){let n;const r=t.defaultButtonName;return t.defaultButtonName?(n=this.buttonsOrder.findIndex(s=>s.name===r),n===-1&&console.warn(`no default menu button found with name: ${r}`)):n=0,n}static HandleButtonCallback(t,n){n.callback!==void 0&&n.callback.call(n.callbackContext,t.name)}handleIfCorrectButton(t,n){var r;return n.isCorrect!==!0?!1:(this.playSound((r=this.config)==null?void 0:r.correctSoundKey),this.updateQuizPerformance(n.isCorrect),this.emit(di.OPTION_SELECTED,t.name,n.isCorrect,this),!0)}handleIfIncorrectButton(t,n){var r;return n.isCorrect!==!1?!1:(this.playSound((r=this.config)==null?void 0:r.incorrectSoundKey),cd(t,n.incorrectConfig),this.updateQuizPerformance(n.isCorrect),this.emit(di.OPTION_SELECTED,t.name,n.isCorrect,this),!0)}initButtonsFromConfigs(t){const n=t.thisConfig.buttonsContainer||this.engine.exportRoot.display,r=t.buttonConfigsByName??{};Object.keys(r).forEach(o=>{const l=mt(n,o,this.onButtonPressed,void 0,this);if(l){const u=hd(r[o]);r[o]=u,this.buttonsByConfig.set(u,l),this.buttonsOrder.push(l),l.enabled=u.isDisabled!==!0,l.visible=u.isHidden!==!0}else console.warn("no menu button found with name:",o,"on container:",n),n instanceof createjs.MovieClip&&console.warn("affected frame:",n.currentFrame)})}initDefaultSelectedButton(t){if(this.inputDeviceHandler.isEnabled){const n=this.getDefaultSelectedButtonIndex(t);this.selectButtonAt(n)}}initInputDeviceHandler(){return new Ys(this.engine).on(St.NEXT,this.onInputDeviceNext,this).on(St.SELECT,this.onInputDeviceSelect,this)}onButtonPressed(t){var s,o;const n=t,r=(s=this.config)!=null&&s.buttons?this.config.buttons[n.name]:void 0;if(!O(r)){console.warn("no menu button config found for menu button with name:",n.name);return}if(this.handleIfIncorrectButton(n,r)){Zt.HandleButtonCallback(n,r);return}this.handleIfCorrectButton(n,r),(o=this.config)!=null&&o.shouldCloseMenu&&this.engine.unpresentMenu(),Zt.HandleButtonCallback(n,r)}onInputDeviceNext(){this.selectNextButton()}onInputDeviceSelect(){this.confirmSelectedButton()}playSound(t){t&&this.engine.playSound(t)}selectButtonAt(t){const n=this.selectedButton,r=this.buttonsOrder[t];n!==r&&(this.selectedButtonIndex=t,n==null||n.setSelected(!1),r==null||r.setSelected(!0))}get selectedButton(){return this.buttonsOrder[this.selectedButtonIndex]}selectNextButton(){this.buttonsOrder.length>0&&this.selectButtonAt((this.selectedButtonIndex+1)%this.buttonsOrder.length)}uninitResources(){this.inputDeviceHandler.dispose(),this.disposeButtons(),this.config=void 0}updateQuizPerformance(t){this.quizData&&(this.quizData.numAttempts+=1,t&&(this.quizData.percentageCorrect=1/this.quizData.numAttempts))}}function dd(i){return O(i)&&("defaultSelectedNavButtonId"in i||"navButtonsToHide"in i||"params"in i)}function pd(i){return O(i)&&Object.keys(i).every(e=>ke(e,Do))}function fd(i){let e;return dd(i)?e=i:pd(i)?e={params:i}:e={},e.defaultSelectedNavButtonId??(e.defaultSelectedNavButtonId=E.SelectedNavButtonId),e}const pi={};function gd(i){const e=i.lastIndexOf(".");return e===-1?i:i.substring(0,e)}function yd(i){const e=i.lastIndexOf("/");return e===-1?i:i.substring(e+1)}function co(i){let e=gd(i);return e=yd(e),e=e.replace(/[^a-zA-Z0-9_]/g,""),/^\d/.test(e)&&(e=`_${e}`),e}function vd(i){if(typeof i=="string")return co(i);const e=[];return i.forEach(t=>{e.push(co(t))}),e}function md(i){switch(typeof i){case"boolean":return i?-1:0;case"number":return i;default:return 0}}function fi(i,e=1,t=!1,n=void 0,r=void 0){let s;typeof i=="string"?s={audioId:i,callbackContext:r,completeCallback:n,loop:t,volume:e}:s=i;const o=vd(s.audioId),l=createjs.Sound.play(o);if(l.playState===createjs.Sound.PLAY_FAILED){console.warn(`failed to play sound: ${s.audioId}. resolved audio id: ${o}`),l.destroy();return}return s.completeCallback&&new Oe(l).once(m.COMPLETE,s.completeCallback,s.callbackContext),l.loop=md(s.loop),l.volume=s.volume??1,l}function te(i){if(i.currentIndex>=i.soundIds.length){i.resolve();return}const e=i.soundIds[i.currentIndex];if(!e){i.currentIndex+=1,te(i);return}const t=fi(e,i.volume);if(!t){i.currentIndex+=1,te(i);return}t.on(m.COMPLETE,()=>{i.currentIndex+=1,te(i)},void 0,!0),t.on(m.ERROR,()=>{console.warn("failed to play sound:",t),i.currentIndex+=1,te(i)})}function Sd(i,e){return new Promise(t=>{const n={currentIndex:0,resolve:t,soundIds:Array.isArray(i)?[...i]:[i],volume:e};te(n)})}function bd(i){return _e(i)&&i>=0}function ho(i){return i instanceof createjs.MovieClip}function Cd(i){return _e(i)&&i>0}class Bd{constructor(e,t){a(this,"indicator");a(this,"timer");this.indicator=e,Cd(t)&&this.start(t)}start(e){return this.hide(),this.startTimer(e),this}stop(){return this.hide(),this.stopTimer(),this}hide(){this.indicator.visible=!1,ho(this.indicator)&&this.indicator.stop()}show(){this.indicator.visible=!0,ho(this.indicator)&&this.indicator.gotoAndPlay(0)}startTimer(e){this.stopTimer(),this.timer=dt.Create({callback:()=>{this.show()},delayMs:e})}stopTimer(){var e;(e=this.timer)==null||e.stop(),this.timer=void 0}}const Ge=class Ge{constructor(e){a(this,"engine");a(this,"indicator");this.engine=e}start(e=void 0,t=void 0,n=Ge.DEFAULT_NAME){const r=pt(t??this.engine.exportRoot.display,n);if(!r){console.warn(`no display object found with name: ${n}`);return}if(this.indicator=new Bd(r),this.engine.userSettingsData.device.inputDevice!==Y.TapMouse){this.indicator.stop();return}this.indicator.start(e??this.engine.config.pressIndicatorDelay),this.engine.exportRoot.display.on(m.MOUSE_DOWN,()=>{this.indicator&&(this.indicator.stop(),this.indicator=void 0)},this,!0)}stop(){var e;(e=this.indicator)==null||e.stop(),this.indicator=void 0}updateBgmFromSettings(){this.engine.userSettingsData.device.inputDevice!==Y.TapMouse&&this.stop()}};a(Ge,"DEFAULT_NAME","pressIndicatorDisplay");let gi=Ge;async function Pd(i,e,t){return new Promise(n=>{var r;Ct.Create(i.exportRoot.stage,e,i.lib.animateClasses.MessagePanelCloseDisplay,{autoClose:!0}),t?(r=$t.Get())==null||r.once(oi.CLOSE,()=>{n()}):n()})}async function Ed(i,e,t){return new Promise(n=>{let r,s=!1;const o=e.writeToLocalStorage();if(o?(r=t==null?void 0:t.successMessage,s=!0):(console.warn("unable to write settings to local storage"),r=t==null?void 0:t.failMessage),r){(async()=>(await Pd(i,r,s),n(o)))();return}n(o)})}function po(){return{failMessage:"Unable to update settings.",successMessage:"Settings have been updated!"}}class Dd extends Rt{constructor(t,n){super(t,n);a(this,"subPanel");this.subPanel=new so(this,n.lib),this.subPanel.setSettings(n.userSettingsData.device),this.subPanel.updateFromSettings()}present(){return this.visible=!0,this}unpresent(){return this.visible=!1,this}async onClosePressed(){this.subPanel.areSettingsDirty&&await this.engine.saveSettings(po()),super.onClosePressed()}}function ee(i){return new Promise(e=>{dt.Create({delayMs:i,callback:()=>{e()}})})}const wd={PlayIntroSound:"play_intro_sound"};class Td extends Rt{constructor(t,n){super(t,n);a(this,"scene");a(this,"isSoundResolved");a(this,"isSceneResolved");a(this,"soundInstance");this.scene=new ri(n,t),this.scene.addFrameCallback(wd.PlayIntroSound,this.onPlayIntroSound,this),this.scene.addFrameCallback(this.scene.totalFrames-1,this.onComplete,this),this.isSceneResolved=!1,this.isSoundResolved=!1}dispose(){this.stopSound(),this.isSceneResolved=!1,this.isSoundResolved=!1,this.scene.dispose(),super.dispose()}present(){return this.stopSound(),this.isSceneResolved=!1,this.isSoundResolved=!1,this.scene.playTo(this.scene.totalFrames-1,0),this.visible=!0,this}async continueIfAllAreResolved(){this.isSceneResolved&&this.isSoundResolved&&(await ee(w.IntroCompleteWaitDelayMs),this.emit(it.CLOSE,this))}onPlayIntroSound(){this.soundInstance=this.engine.playSound({audioId:this.engine.lib.audioIds.Logo,completeCallback:()=>{this.resolveSound()}}),this.soundInstance||this.resolveSound()}onComplete(){this.resolveScene()}resolveScene(){this.isSceneResolved=!0,this.continueIfAllAreResolved()}resolveSound(){this.isSoundResolved=!0,this.continueIfAllAreResolved()}stopSound(){var t;(t=this.soundInstance)==null||t.destroy(),this.soundInstance=void 0}}class yi{constructor(e){a(this,"engine");a(this,"_quizzes");a(this,"sessionStartTime");a(this,"sessionDurationMs");a(this,"sbCookies");this.engine=e,this._quizzes=[],this.sessionStartTime=0,this.sessionDurationMs=0}addQuizData(e){this._quizzes.push(F(e))}get quizzes(){return qe(this._quizzes)}removeAllQuizzes(){this._quizzes.length=0}start(){this.sessionStartTime=Date.now(),this.sessionDurationMs=0}stop(){if(this.sessionStartTime===0)return;const e=Date.now();this.sessionDurationMs=Math.max(0,e-this.sessionStartTime),this.sessionStartTime=0}submit(){if(this.stop(),this.sessionDurationMs===0){console.warn("no session is currently being recorded. first start a session with the start method");return}this.sbCookies||(this.sbCookies=(Pt.noConflict?Pt.noConflict():Pt).withConverter({read:r=>r,write:r=>r.replace(/%25/g,"%")}));const e=this.calculateTotalTimeMin();this.sbCookies.set("Totaltime",e.toString(10));const t=this.calculateTotalSelection();this.sbCookies.set("TotalSelection",t.toString(10));const n=this.calculatePercentageCorrect();this.sbCookies.set("Percentage_correct",yi.FormatPercentage(n)),console.info("total time (mins):",e),console.info("total selectionm:",t),console.info("average percentage correct:",n)}calculatePercentageCorrect(){return this._quizzes.length===0?0:this._quizzes.reduce((n,r)=>n+r.percentageCorrect,0)/this._quizzes.length}calculateTotalSelection(){return this._quizzes.reduce((e,t)=>e+t.totalSelection,0)}calculateTotalTimeMin(){return this.sessionDurationMs/1e3/60}static FormatPercentage(e){return`${(e*100).toFixed(2)}%`}}function xd(i){i&&i.destroy()}const q={DevicesPanel:"devicesPanelDisplay",MainPanel:"mainPanelDisplay",PasscodePanel:"passcodePanelDisplay",SettingsPanel:"settingsPanelDisplay",TiggieIntro:"tiggieIntroDisplay",VideoContainer:"videoContainer"};class fo extends X{constructor(t,n){super();a(this,"exportRoot");a(this,"lib");a(this,"contentHandler");a(this,"startTimelineFrame");a(this,"userPerformanceData");a(this,"contextLayers");a(this,"userSettings");a(this,"engineConfig");a(this,"pressIndicatorMgr");a(this,"mainPanel");a(this,"passcodePanel");a(this,"settingsPanel");a(this,"devicesPanel");a(this,"buttonsMenu");a(this,"tiggieIntro");a(this,"sceneHandler");a(this,"navParams");a(this,"bgmSoundInstance");a(this,"previousSettingsData");this.exportRoot=new ri(this,t),this.lib={animateClasses:n,audioIds:Bo,header:n},this.exportRoot.display.framerate=this.lib.header.properties.fps,this.engineConfig=F(E.EngineConfig),this.userSettings=new vh,this.startTimelineFrame=this.getStartTimelineFrame(),this.contextLayers=new Ch(this),this.contentHandler=new Yh(this),this.pressIndicatorMgr=new gi(this),this.userPerformanceData=new yi(this),this.initMainPanel().initPasscodePanel().initSettingsPanel().initDevicesPanel().initTiggieIntro(),createjs.Ticker.on(m.TICK,()=>{this.exportRoot.stop(Xe.SbInit)},this,!0)}get config(){return this.engineConfig}get contentVideoElement(){return this.contentHandler.videoElement}createMessagePanel(t,n,r){return Ct.Create(this.exportRoot.stage,t,n,r)}async deleteProgress(t){if(t??(t=this.config.storybookId),!t)return console.warn("no storybook id specified"),!1;const{storybooksStates:n}=this.userSettings.data;return t in n?(delete n[t],await this.saveSettings()?(console.info(`progress deleted for storybook id "${t}"`),!0):!1):!0}dispose(){var t,n,r,s;super.removeAllListeners(),(t=this.buttonsMenu)==null||t.dispose(),this.buttonsMenu=void 0,this.contentHandler.dispose(),(n=this.mainPanel)==null||n.dispose(),this.mainPanel=void 0,(r=this.passcodePanel)==null||r.dispose(),this.passcodePanel=void 0,(s=this.settingsPanel)==null||s.dispose(),this.settingsPanel=void 0}init(t){return od(t,this.lib,this.engineConfig),console.info("Storybook engine config: %o",this.engineConfig),this.initSceneHandler(),this.engineConfig.storybookId&&this.deleteProgressUsingQueryParam(this.engineConfig.storybookId),this.presentDevicesPanel(),this}static LogVersion(){const t=["background: blue","color: yellow","display: block"].join(";");console.info(`%cStorybookEngine v: ${w.Version}`,t)}playBgm(t,n){return t?(this.stopBgm(),n=this.userSettingsData.audio.bgm.isEnabled?this.resolveSettingsVolume(st.Bgm,n):0,this.bgmSoundInstance=fi(t,n,!0),!!this.bgmSoundInstance):!1}playSound(t,n=1,r=!1,s=void 0,o=void 0){if(!this.userSettingsData.audio.sound.isEnabled)return;const l=typeof t=="string"?{audioId:t,callbackContext:o,completeCallback:s,loop:r,volume:n}:t;if(l.audioId)return l.volume=this.resolveSettingsVolume(st.Sound,l.volume),fi(l)}playVoice(t,n){return n=this.resolveSettingsVolume(st.Voice,n),Sd(t,n)}presentMenu(t){this.unpresentMenu(),this.buttonsMenu=new Zt(this),this.buttonsMenu.on(di.OPTION_SELECTED,this.onButtonsMenuOptionPressed,this);const n=t??{};return this.config.buttonsMenu&&(n.correctSoundKey??(n.correctSoundKey=this.config.buttonsMenu.defaultCorrectSoundKey),n.incorrectSoundKey??(n.incorrectSoundKey=this.config.buttonsMenu.defaultInorrectSoundKey)),this.buttonsMenu.start(n),this}presentNav(t){var r;const n=fd(t);return this.navParams=n.params,(r=this.mainPanel)==null||r.presentNavUi(n),this}get progress(){var t,n;return((n=(t=this.mainPanel)==null?void 0:t.progressBar)==null?void 0:n.value)??0}set progress(t){var n;(n=this.mainPanel)!=null&&n.progressBar&&(this.mainPanel.progressBar.value=t)}resolveSettingsVolume(t,n){if(bd(n))return n;const r=this.userSettings.data.audio[t];return r!=null&&r.isEnabled?r.volume:0}async saveProgress(t,n){if(t??(t=this.config.storybookId),!t)return console.warn("no storybook id specified"),!1;if(n!==void 0){if(!this.exportRoot.isFrameValid(n))return console.warn(`invalid progress frame or label specified: ${n}`),!1}else n=this.exportRoot.currentFrame;const{storybooksStates:r}=this.userSettings.data;let s=r[t];return s||(s={},r[t]=s),s.progresFrameOrLabel=n,await this.saveSettings()&&console.info(`progress saved for storybook id "${t}" @: ${n}`),!1}async saveSettings(t){return Ed(this,this.userSettings,t)}static SbDocPrep(){nd()}setBgmVolume(t){return this.bgmSoundInstance&&(this.bgmSoundInstance.volume=t),this}startPressIndicator(t,n,r){return this.pressIndicatorMgr.start(t,n,r),this}startSceneHandler(){var t;return(t=this.sceneHandler)==null||t.run(),this}stopBgm(){return this.bgmSoundInstance=xd(this.bgmSoundInstance),this}async storybookComplete(t){this.submitUserPerformanceData();const n=Pt.noConflict?Pt.noConflict():Pt,r="gameURL",s=n.get(r);if(!s){console.warn("no redirect url found in cookeis with key:",r);return}t??(t=w.ExitRedirectDelayMs),await ee(t),this.exitRedirect(s)}submitUserPerformanceData(){return this.userPerformanceData.submit(),this}unpresentMenu(){var t;return(t=this.buttonsMenu)==null||t.dispose(),this.buttonsMenu=void 0,this}updateFromSettings(){var t;return this.contextLayers.updateFromSettings(),(t=this.buttonsMenu)==null||t.updateFromSettings(),this.updateBgmFromSettings(),this.pressIndicatorMgr.updateBgmFromSettings(),this}get userSettingsData(){return this.userSettings.data}get videoContainer(){return Re(this.exportRoot.display,q.VideoContainer)}closeSettingsPanel(){var t,n;this.restorePreviousSettings(),(t=this.settingsPanel)==null||t.unpresent(),(n=this.mainPanel)==null||n.updateFromSettings(),this.updateFromSettings()}continueAftarTutorial(){this.updateFromSettings(),this.presentContent()}deleteProgressUsingQueryParam(t){je(Ue.DeleteProgress)!==null&&this.deleteProgress(t)}async exitRedirect(t){t??(t=je(Ue.ExitRedirect)??this.config.exitRedirectUrl),t?window.location.replace(t):console.warn("no redirect url specified")}getStartTimelineFrame(){const t=pi.StartLabel?pi.StartLabel:Xe.Start;let n;if(typeof t=="string"){const r=ze(this.exportRoot.display).find(s=>s.label===t);n=(r==null?void 0:r.position)??this.exportRoot.currentFrame+1}else n=t;return console.info("start frame number:",n),n}async handleNavAction(t,n){var r;(r=this.mainPanel)==null||r.unpresentNavUi(),await this.playNavButtonSound(),n?this.contentHandler.navTo(t,n):this.contentHandler.resume(Jt.IsFromNav)}initDevicesPanel(){const t=P(this.exportRoot.display,q.DevicesPanel);return t?(this.devicesPanel=new Dd(t,this).addListener(it.CLOSE,this.onDevicesPanelClose,this).setVisible(!1),this):(console.warn("no devices panel found with name:",q.DevicesPanel),this)}initMainPanel(){var n;const t=P(this.exportRoot.display,q.MainPanel);return t?(this.mainPanel=new Fh(t,this).addListener(k.NEXT,this.onMainPanelNextPressed,this).addListener(k.PREV,this.onMainPanelPrevPressed,this).addListener(k.RESTART,this.onMainPanelRestartPressed,this).addListener(k.SETTINGS,this.onMainPanelSettingsPressed,this).setVisible(!0).unpresentNavUi(),(n=this.mainPanel.progressBar)==null||n.setVisible(!1),this):(console.warn("no main panel found with name:",q.MainPanel),this)}initPasscodePanel(){const t=P(this.exportRoot.display,q.PasscodePanel);return t?(this.passcodePanel=new Hh(t,this).addListener(it.CLOSE,this.onPasscodePanelClose,this).addListener(li.SUBMIT,this.onPasscodePanelSubmit,this).setVisible(!1),this):(console.warn("no passcode panel found with name:",q.PasscodePanel),this)}initSceneHandler(){const t=this.config.sceneHandler;t&&(this.sceneHandler=new t(this))}initSettingsPanel(){const t=P(this.exportRoot.display,q.SettingsPanel);return t?(this.settingsPanel=new Kh(t,this).addListener(it.CLOSE,this.onSettingsPanelClose,this).addListener(He.EXIT,this.onSettingsPanelExit,this).addListener(He.SAVE,this.onSettingsPanelSave,this).setVisible(!1),this):(console.warn("no settings panel found with name:",q.SettingsPanel),this)}initTiggieIntro(){const t=P(this.exportRoot.display,q.TiggieIntro);return t?(this.tiggieIntro=new Td(t,this).addListener(it.CLOSE,this.onTiggieIntroClose,this).setVisible(!1),this):(console.warn("no tiggie intro display found with name:",q.TiggieIntro),this)}onButtonsMenuOptionPressed(t,n,r){n&&r.quizData&&(this.userPerformanceData.addQuizData(r.quizData),console.info("user performance data:",this.userPerformanceData))}onDevicesPanelClose(){this.devicesPanel&&(this.devicesPanel.unpresent().dispose(),this.devicesPanel=void 0),this.presentTutorial()||this.presentContent()}onMainPanelNextPressed(){this.handleNavAction(I.Next,this.navParams)}onMainPanelPrevPressed(){this.handleNavAction(I.Prev,this.navParams)}onMainPanelRestartPressed(){this.handleNavAction(I.Restart,this.navParams)}onMainPanelSettingsPressed(){var t,n;(t=this.mainPanel)==null||t.setVisible(!1),w.AreSettingsProtected?(n=this.passcodePanel)==null||n.present():this.presentSettingsPanel()}onPasscodePanelClose(){var t,n;(t=this.passcodePanel)==null||t.unpresent(),(n=this.mainPanel)==null||n.setVisible(!0)}onPasscodePanelSubmit(t){var n,r,s;t?((n=this.mainPanel)==null||n.setVisible(!1),(r=this.passcodePanel)==null||r.setVisible(!1),this.presentSettingsPanel()):(s=this.passcodePanel)==null||s.clearAnswer()}onSettingsPanelClose(){this.closeSettingsPanel()}onSettingsPanelExit(){this.createMessagePanel("Are you sure you want to exit the activity?",this.lib.animateClasses.MessagePanelYNDisplay).then(t=>{t===et.Yes&&this.exitRedirect()})}async onSettingsPanelSave(t){this.userSettings.apply(t.settingsData),this.previousSettingsData=void 0,await this.saveSettings(po()),this.closeSettingsPanel()}onTiggieIntroClose(){var t;(t=this.tiggieIntro)==null||t.dispose()}async playNavButtonSound(){return new Promise(t=>{this.config.shouldWaitForNavSounds?this.playSound({audioId:this.config.navButtonsSoundKey,completeCallback:()=>{t()}})||t():(this.playSound(this.config.navButtonsSoundKey),t())})}presentContent(){const{storybookId:t}=this.engineConfig,n=t?this.userSettings.data.storybooksStates[t]:void 0;(n==null?void 0:n.progresFrameOrLabel)===void 0?(this.presentContent2(),this.contentHandler.start()):this.createMessagePanel("Would you like to resume form where you left off?",this.lib.animateClasses.MessagePanelYNDisplay,{buttonLabels:{[et.Yes]:"Yes, Resume",[et.No]:"No, Restart"}}).then(r=>{let s;r===et.Yes?(s=n.progresFrameOrLabel,typeof s=="number"&&(s+=1)):(t&&this.deleteProgress(t),s=0),this.presentContent2(s)})}presentContent2(t){!this.tiggieIntro||this.shouldSkipIntro()?this.presentContent3(t):(this.tiggieIntro.present(),this.tiggieIntro.once(it.CLOSE,()=>{var n;(n=this.tiggieIntro)==null||n.dispose(),this.tiggieIntro=void 0,this.presentContent3(t)}))}presentContent3(t){this.mainPanel&&(this.mainPanel.settingsButtonVisible=!0),this.contentHandler.start(t),this.contextLayers.start(),this.startSceneHandler(),this.userPerformanceData.start()}presentDevicesPanel(){this.devicesPanel?(this.mainPanel&&(this.mainPanel.settingsButtonVisible=!1),this.devicesPanel.present()):this.presentTutorial()||this.presentContent()}presentSettingsPanel(){var t;this.previousSettingsData=F(this.userSettings.data),(t=this.settingsPanel)==null||t.present(this.userSettings.data)}presentTutorial(){return!this.mainPanel||!this.shouldShowTutorial()||!this.mainPanel.presentTutorial()?!1:(this.mainPanel.once(k.TUTORIAL_COMPLETE,async t=>{var n;t&&(this.userSettings.data.hasCompletedTutorial=!0,await this.saveSettings()),(n=this.mainPanel)==null||n.unpresentTutorial(),this.continueAftarTutorial()}),!0)}restorePreviousSettings(){this.previousSettingsData&&(this.userSettings.apply(this.previousSettingsData),this.previousSettingsData=void 0)}shouldShowTutorial(){return!this.userSettingsData.hasCompletedTutorial}shouldSkipIntro(){return pi.ShouldSkipIntro||this.config.shouldSkipIntro}updateBgmFromSettings(){this.bgmSoundInstance&&(this.bgmSoundInstance.volume=this.userSettingsData.audio.bgm.isEnabled?this.userSettings.data.audio.bgm.volume:0)}}class Ad{constructor(e){a(this,"engine");this.engine=e}get exportRoot(){return this.engine.exportRoot}}const vi=1500;function Id(i){i.playSound("snd_complete.mp3"),i.engine.storybookComplete()}function kd(i){i.playSound("snd_star_intro.mp3"),i.playTo("quiz_correct_end","quiz_correct_begin",()=>{Id(i)})}function _d(i){i.stop("quiz_menu"),i.engine.presentMenu({buttons:{sinkButtonDisplay:{isCorrect:!1},sinkSpeakerButtonDisplay:{callback:()=>{i.playVoices("SBL0001_WherecanLucypeeIsitint_480k_stereowav")}},floorButtonDisplay:{isCorrect:!1},floorSpeakerButtonDisplay:{callback:()=>{i.playVoices("SBL0002_Onthefloor_480k_stereowav")}},toiletButtonDisplay:{isCorrect:!0,callback:()=>{i.engine.unpresentMenu(),kd(i)}},toiletSpeakerButtonDisplay:{callback:()=>{i.playVoices("SBL0003_orinthetoiletbowl_480k_stereowav")}}},defaultButtonName:"sinkButtonDisplay",isQuiz:!0,shouldCloseMenu:!1})}async function Md(i){await i.playSyncVoice("SBL0001_WherecanLucypeeIsitint_480k_stereowav","quiz_voc_begin","quiz_voc_end"),await ee(vi),await i.playSyncVoice("SBL0002_Onthefloor_480k_stereowav","quiz_floor_voc_begin","quiz_floor_voc_end"),await ee(vi),await i.playSyncVoice("SBL0003_orinthetoiletbowl_480k_stereowav","quiz_toilet_voc_begin","quiz_toilet_voc_end"),await ee(vi),_d(i)}function Od(i){i.playTo("quiz_open_end","quiz_open_begin",()=>{Md(i)})}function Fd(i){i.playTo("where_pee_complete","acc_pee_end",()=>{Od(i)})}async function Rd(i){await i.playSyncVoice("SBL0006_Where_480k_stereowav","aac_where_begin","aac_where_end"),await i.playSyncVoice("SBL0007_pee_480k_stereowav","acc_pee_begin","acc_pee_end"),i.engine.presentNav({next:{callback:()=>{Fd(i)}},prev:{callback:()=>{go(i)}},restart:{callback:()=>{i.engine.startSceneHandler()}}})}function go(i){i.playTo("run_toilet_wait_end","run_toilet_wait_begin",async()=>{await i.playSyncVoice("SBL0002_butwherecanshepee_480k_stereowav","voc_where_pee_begin","voc_where_pee_end"),i.playTo("aac_where_begin","voc_where_pee_end",()=>{Rd(i)})})}async function Nd(i){await i.playSyncVoice("SBL0004_run_480k_stereowav","run_aac_begin","run_aac_end"),await i.playSyncVoice("SBL0005_toilet_480k_stereowav","toilet_aac_begin","toilet_aac_end"),i.engine.presentNav({next:{callback:()=>{go(i)}},prev:{callback:()=>{i.engine.startSceneHandler()}},restart:{callback:()=>{i.engine.startSceneHandler()}}})}function $d(i){i.playTo("voc_runs_toilet_begin",Xe.Start,async()=>{await i.playSyncVoice("SBL-0001_Sherunstothetoilet_480k_stereowav","voc_runs_toilet_begin","voc_runs_toilet_end"),i.engine.presentNav({defaultSelectedNavButtonId:"next",navButtonsToHide:["prev","restart"],params:{next:{callback:()=>{Nd(i)}}}})})}class Ld extends Ad{run(){this.engine.playBgm("bgm_hit_the_big_timethe_flamingo"),$d(this.exportRoot)}}const Hd=Object.freeze(Object.defineProperty({__proto__:null,LucyPeeScene2Handler:Ld},Symbol.toStringTag,{value:"Module"}));fo.LogVersion(),M.Engine=fo,M.SceneHandlers=Hd,Object.defineProperty(M,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=storybook-engine.umd.js.map
